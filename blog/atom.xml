<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xsl" href="atom.xsl"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://www.iogl.cn/blog</id>
    <title>Vulkan Guide Blog</title>
    <updated>2025-07-30T13:17:18.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://www.iogl.cn/blog"/>
    <subtitle>Vulkan Guide Blog</subtitle>
    <icon>https://www.iogl.cn/img/fav.png</icon>
    <entry>
        <title type="html"><![CDATA[KHR_buffer_device_address的用法]]></title>
        <id>https://www.iogl.cn/blog/20.KHR_buffer_device_address的用法</id>
        <link href="https://www.iogl.cn/blog/20.KHR_buffer_device_address的用法"/>
        <updated>2025-07-30T13:17:18.000Z</updated>
        <summary type="html"><![CDATA[VKKHRbufferdeviceaddress 扩展是 Vulkan 中非常重要的一个功能，它允许你从 GPU 上直接获取 Buffer 的“设备地址”，从而支持：]]></summary>
        <content type="html"><![CDATA[<p><code>VK_KHR_buffer_device_address</code> 扩展是 Vulkan 中非常重要的一个功能，它允许你<strong>从 GPU 上直接获取 Buffer 的“设备地址”</strong>，从而支持：</p>
<blockquote>
<p>✅ <strong>指针式 GPU 编程</strong>（如 GPU 上的结构体链表、指针跳转等）</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-简单理解它的作用是什么">🧩 简单理解：它的作用是什么？<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#-%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3%E5%AE%83%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88" class="hash-link" aria-label="🧩 简单理解：它的作用是什么？的直接链接" title="🧩 简单理解：它的作用是什么？的直接链接">​</a></h2>
<p>传统 Vulkan 中，GPU 无法知道 buffer 在设备上的地址，只能通过 binding 来访问。但开启 <code>VK_KHR_buffer_device_address</code> 后：</p>
<blockquote>
<p>你可以在 GPU shader 中使用设备地址 (<code>deviceAddress</code>) 指向某个 Buffer 的任意位置，像指针一样访问内存。</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-主要作用和用途">✅ 主要作用和用途<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#-%E4%B8%BB%E8%A6%81%E4%BD%9C%E7%94%A8%E5%92%8C%E7%94%A8%E9%80%94" class="hash-link" aria-label="✅ 主要作用和用途的直接链接" title="✅ 主要作用和用途的直接链接">​</a></h2>
<table><thead><tr><th>作用</th><th>示例用途</th></tr></thead><tbody><tr><td>1️⃣ 获取 GPU 上的 buffer 地址</td><td><code>vkGetBufferDeviceAddress</code> 取得指针</td></tr><tr><td>2️⃣ Shader 中可以操作 raw 设备地址</td><td>用于构造链表、树、BVH 等</td></tr><tr><td>3️⃣ 启用 GPU pointer 计算</td><td>类似 C++ 指针，在 Shader 里操作内存</td></tr><tr><td>4️⃣ 实现自定义内存管理器</td><td>动态分配、跳转、遍历 GPU 数据结构</td></tr><tr><td>5️⃣ 支持 RTX 和加速结构（如 BLAS/TLAS）</td><td>必须要求 device address</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-示例获取-buffer-的设备地址">🧪 示例：获取 Buffer 的设备地址<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#-%E7%A4%BA%E4%BE%8B%E8%8E%B7%E5%8F%96-buffer-%E7%9A%84%E8%AE%BE%E5%A4%87%E5%9C%B0%E5%9D%80" class="hash-link" aria-label="🧪 示例：获取 Buffer 的设备地址的直接链接" title="🧪 示例：获取 Buffer 的设备地址的直接链接">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkBufferDeviceAddressInfo addr_info = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .sType = VK_STRUCTURE_TYPE_BUFFER_DEVICE_ADDRESS_INFO,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .buffer = myBuffer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkDeviceAddress addr = vkGetBufferDeviceAddress(device, &amp;addr_info);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个地址可以传入 Shader，通过 <code>uint64_t</code> 接收，然后做指针跳转或访问。</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-glsl-中怎么使用">✍️ GLSL 中怎么使用？<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#%EF%B8%8F-glsl-%E4%B8%AD%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8" class="hash-link" aria-label="✍️ GLSL 中怎么使用？的直接链接" title="✍️ GLSL 中怎么使用？的直接链接">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">glsl复制编辑#extension GL_EXT_buffer_reference : enable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#extension GL_EXT_buffer_reference2 : enable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#extension GL_EXT_scalar_block_layout : enable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout(buffer_reference, scalar) buffer Node;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct Node {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float value;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Node next;   // 嵌套引用</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout(set = 0, binding = 0) buffer Root {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Node root;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void main() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Node current = root;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while (current.value &lt; 10.0) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        current = current.next;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这在传统 Vulkan 是<strong>无法实现</strong>的。</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-使用步骤">🚀 使用步骤<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#-%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4" class="hash-link" aria-label="🚀 使用步骤的直接链接" title="🚀 使用步骤的直接链接">​</a></h2>
<ol>
<li><strong>开启扩展：</strong></li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑enabledExtensions = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  "VK_KHR_buffer_device_address"</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol>
<li><strong>启用设备特性：</strong></li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkPhysicalDeviceBufferDeviceAddressFeatures features = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .sType = VK_STRUCTURE_TYPE_PHYSICAL_DEVICE_BUFFER_DEVICE_ADDRESS_FEATURES,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .bufferDeviceAddress = VK_TRUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol>
<li><strong>创建 buffer 时加 flag：</strong></li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">复制编辑</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bufferCreateInfo.usage |= VK_BUFFER_USAGE_SHADER_DEVICE_ADDRESS_BIT;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol>
<li><strong>调用 <code>vkGetBufferDeviceAddress()</code> 获取地址</strong></li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-注意事项">⚠️ 注意事项<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#%EF%B8%8F-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" class="hash-link" aria-label="⚠️ 注意事项的直接链接" title="⚠️ 注意事项的直接链接">​</a></h2>
<table><thead><tr><th>限制</th><th>描述</th></tr></thead><tbody><tr><td>必须 GPU 驱动支持该扩展</td><td></td></tr><tr><td>必须设置 <code>VK_BUFFER_USAGE_SHADER_DEVICE_ADDRESS_BIT</code></td><td></td></tr><tr><td>仅支持 Vulkan 1.2+ 或通过扩展开启</td><td></td></tr><tr><td>使用 device address 意味着需要注意对齐、访问合法性（你在 shader 中“越界”会引发 crash）</td><td></td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-总结">✅ 总结<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#-%E6%80%BB%E7%BB%93" class="hash-link" aria-label="✅ 总结的直接链接" title="✅ 总结的直接链接">​</a></h2>
<table><thead><tr><th>项目</th><th>说明</th></tr></thead><tbody><tr><td>扩展名</td><td><code>VK_KHR_buffer_device_address</code></td></tr><tr><td>作用</td><td>获取 Buffer 的 GPU 设备地址</td></tr><tr><td>用途</td><td>GPU 指针访问、加速结构（如 RTX）、GPU 内存池等</td></tr><tr><td>Shader 访问</td><td>GLSL/GL_EXT_buffer_reference + 指针跳转</td></tr><tr><td>Vulkan API</td><td><code>vkGetBufferDeviceAddress</code></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例">示例<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#%E7%A4%BA%E4%BE%8B" class="hash-link" aria-label="示例的直接链接" title="示例的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1️⃣-vulkan-端准备">1️⃣ Vulkan 端准备<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#1%EF%B8%8F%E2%83%A3-vulkan-%E7%AB%AF%E5%87%86%E5%A4%87" class="hash-link" aria-label="1️⃣ Vulkan 端准备的直接链接" title="1️⃣ Vulkan 端准备的直接链接">​</a></h3>
<p><strong>启用扩展</strong> <code>VK_KHR_buffer_device_address</code> 并设置特性</p>
<p><strong>创建 buffer</strong> 时加上 <code>VK_BUFFER_USAGE_SHADER_DEVICE_ADDRESS_BIT</code></p>
<p><strong>分配内存</strong> 时加上 <code>VK_MEMORY_ALLOCATE_DEVICE_ADDRESS_BIT</code></p>
<p><strong>读取 GPU 地址</strong> 使用 <code>vkGetBufferDeviceAddress</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 1. 在 VkDeviceCreateInfo 的 pNext 链中启用特性</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkPhysicalDeviceBufferDeviceAddressFeaturesKHR bda_feat{};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bda_feat.sType = VK_STRUCTURE_TYPE_PHYSICAL_DEVICE_BUFFER_DEVICE_ADDRESS_FEATURES_KHR;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bda_feat.bufferDeviceAddress = VK_TRUE;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkPhysicalDeviceFeatures2 features2{VK_STRUCTURE_TYPE_PHYSICAL_DEVICE_FEATURES2};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">features2.pNext = &amp;bda_feat;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkGetPhysicalDeviceFeatures2(physDevice, &amp;features2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkDeviceCreateInfo di{VK_STRUCTURE_TYPE_DEVICE_CREATE_INFO};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">di.pNext = &amp;features2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCreateDevice(physDevice, &amp;di, nullptr, &amp;device);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 2. 创建 buffer 并分配支持 device address 的 memory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkBufferCreateInfo bi{VK_STRUCTURE_TYPE_BUFFER_CREATE_INFO};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bi.size = sizeof(Node) * MAX_NODES;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bi.usage = VK_BUFFER_USAGE_STORAGE_BUFFER_BIT | VK_BUFFER_USAGE_SHADER_DEVICE_ADDRESS_BIT;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkBuffer buf;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCreateBuffer(device, &amp;bi, nullptr, &amp;buf);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkMemoryRequirements mr;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkGetBufferMemoryRequirements(device, buf, &amp;mr);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkMemoryAllocateFlagsInfo flagsInfo{VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_FLAGS_INFO};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">flagsInfo.flags = VK_MEMORY_ALLOCATE_DEVICE_ADDRESS_BIT_KHR;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkMemoryAllocateInfo mai{VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mai.allocationSize = mr.size;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mai.memoryTypeIndex = find_mem_type(mr.memoryTypeBits, VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mai.pNext = &amp;flagsInfo;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkDeviceMemory mem;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkAllocateMemory(device, &amp;mai, nullptr, &amp;mem);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkBindBufferMemory(device, buf, mem, 0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 3. 获取 GPU 地址</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkBufferDeviceAddressInfoKHR addrInfo{VK_STRUCTURE_TYPE_BUFFER_DEVICE_ADDRESS_INFO_KHR};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">addrInfo.buffer = buf;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uint64_t gpuAddr = vkGetBufferDeviceAddressKHR(device, &amp;addrInfo);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2️⃣-cpu-端构造链表数据">2️⃣ CPU 端构造链表数据<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#2%EF%B8%8F%E2%83%A3-cpu-%E7%AB%AF%E6%9E%84%E9%80%A0%E9%93%BE%E8%A1%A8%E6%95%B0%E6%8D%AE" class="hash-link" aria-label="2️⃣ CPU 端构造链表数据的直接链接" title="2️⃣ CPU 端构造链表数据的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct Node { uint32_t data; uint64_t next; };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std::vector&lt;Node&gt; nodes = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  {10, gpuAddr + sizeof(Node)*1},</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  {20, gpuAddr + sizeof(Node)*2},</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  {30, 0ull}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkMemcpyToBuffer(buf, nodes.data(), sizeof(Node) * nodes.size());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里 <code>next</code> 存储了 GPU 地址，指向下一个节点形成链表。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3️⃣-glsl-shader-中使用指针访问">3️⃣ GLSL Shader 中使用指针访问<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#3%EF%B8%8F%E2%83%A3-glsl-shader-%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%8C%87%E9%92%88%E8%AE%BF%E9%97%AE" class="hash-link" aria-label="3️⃣ GLSL Shader 中使用指针访问的直接链接" title="3️⃣ GLSL Shader 中使用指针访问的直接链接">​</a></h3>
<p>需要开启扩展和 buffer reference：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#version 450</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#extension GL_EXT_buffer_reference : require</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout(buffer_reference, buffer_reference_align=8) buffer Node {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    uint data;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Node next;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout(std430, set=0, binding=0) buffer Root {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Node root;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout(set=0, binding=1) uniform UBO {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    uint dummy; // 可选</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">} ubo;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout(location=0) out uint outData;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void main() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Node cur = root;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while (cur.next != 0u) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cur = cur.next;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    outData = cur.data; // 应该输出 30</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在 shader 中，<code>root</code> 从 descriptor set 0 绑定，并包含 <code>gpuAddr</code>。它直接代表链表起始节点。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-总结步骤">✅ 总结步骤<a href="https://www.iogl.cn/blog/20.KHR_buffer_device_address%E7%9A%84%E7%94%A8%E6%B3%95#-%E6%80%BB%E7%BB%93%E6%AD%A5%E9%AA%A4" class="hash-link" aria-label="✅ 总结步骤的直接链接" title="✅ 总结步骤的直接链接">​</a></h2>
<ol>
<li>启用 <code>VK_KHR_buffer_device_address</code></li>
<li>创建 buffer + device 地址 buffer memory</li>
<li>调用 <code>vkGetBufferDeviceAddress</code></li>
<li>构造链表，写入 GPU 地址</li>
<li>在 GLSL shader 中使用 <code>buffer_reference</code> 指向链表 start</li>
<li>在 shader 中自由跳转、读取结构数据</li>
</ol>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[shader object用法]]></title>
        <id>https://www.iogl.cn/blog/21.shader object</id>
        <link href="https://www.iogl.cn/blog/21.shader object"/>
        <updated>2025-07-30T13:17:18.000Z</updated>
        <summary type="html"><![CDATA[VKEXTshader_object 是 Vulkan 的一个扩展（在 Vulkan 1.3+ 常见 GPU 上支持），其目标是简化 shader 使用流程，提供一种比传统 pipeline 更轻量、更灵活的方式来管理和绑定着色器，不再需要创建复杂的 graphics/compute pipeline 对象。]]></summary>
        <content type="html"><![CDATA[<p><code>VK_EXT_shader_object</code> 是 Vulkan 的一个扩展（在 Vulkan 1.3+ 常见 GPU 上支持），其目标是<strong>简化 shader 使用流程</strong>，提供一种比传统 pipeline 更轻量、更灵活的方式来管理和绑定着色器，<strong>不再需要创建复杂的 graphics/compute pipeline 对象</strong>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-核心作用">✅ 核心作用<a href="https://www.iogl.cn/blog/21.shader%20object#-%E6%A0%B8%E5%BF%83%E4%BD%9C%E7%94%A8" class="hash-link" aria-label="✅ 核心作用的直接链接" title="✅ 核心作用的直接链接">​</a></h2>
<p>传统 Vulkan：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCreateShaderModule</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCreatePipelineLayout</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCreateGraphicsPipelines</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkBeginCommandBuffer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdBindPipeline</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdDraw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkEndCommandBuffer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用 <code>VK_EXT_shader_object</code> 后：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCreateShadersEXT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkBeginCommandBuffer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdBeginRendering</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdBindShadersEXT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdDraw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdEndRendering</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkEndCommandBuffer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-主要优势">🚀 主要优势<a href="https://www.iogl.cn/blog/21.shader%20object#-%E4%B8%BB%E8%A6%81%E4%BC%98%E5%8A%BF" class="hash-link" aria-label="🚀 主要优势的直接链接" title="🚀 主要优势的直接链接">​</a></h2>
<ul>
<li><strong>免 pipeline</strong>：不再需要提前组合多个 shader 成 pipeline</li>
<li><strong>shader 热插拔</strong>：可以动态替换单个阶段（如 fragment shader）</li>
<li><strong>灵活</strong>：非常适合动态渲染系统、调试工具、可编程 pipeline</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-关键结构和函数">🧱 关键结构和函数<a href="https://www.iogl.cn/blog/21.shader%20object#-%E5%85%B3%E9%94%AE%E7%BB%93%E6%9E%84%E5%92%8C%E5%87%BD%E6%95%B0" class="hash-link" aria-label="🧱 关键结构和函数的直接链接" title="🧱 关键结构和函数的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-创建-shader-object">1. 创建 Shader Object<a href="https://www.iogl.cn/blog/21.shader%20object#1-%E5%88%9B%E5%BB%BA-shader-object" class="hash-link" aria-label="1. 创建 Shader Object的直接链接" title="1. 创建 Shader Object的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkShaderCreateInfoEXT shaderInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_SHADER_CREATE_INFO_EXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">stage </span><span class="token operator">=</span><span class="token plain"> VK_SHADER_STAGE_VERTEX_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// 阶段</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">nextStage </span><span class="token operator">=</span><span class="token plain"> VK_SHADER_STAGE_FRAGMENT_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// 可用于管线优化（可设为 0）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">codeType </span><span class="token operator">=</span><span class="token plain"> VK_SHADER_CODE_TYPE_SPIRV_EXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// SPIR-V 类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pCode </span><span class="token operator">=</span><span class="token plain"> spirvData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">codeSize </span><span class="token operator">=</span><span class="token plain"> spirvSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pName </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"main"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">                            </span><span class="token comment" style="color:rgb(98, 114, 164)">// entry point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 可以设置 descriptor layouts 等（类似 pipeline layout）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkShaderEXT shader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCreateShadersEXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">shaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">shader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-绑定-shader代替-vkcmdbindpipeline">2. 绑定 Shader（代替 <code>vkCmdBindPipeline</code>）<a href="https://www.iogl.cn/blog/21.shader%20object#2-%E7%BB%91%E5%AE%9A-shader%E4%BB%A3%E6%9B%BF-vkcmdbindpipeline" class="hash-link" aria-label="2-绑定-shader代替-vkcmdbindpipeline的直接链接" title="2-绑定-shader代替-vkcmdbindpipeline的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">vkCmdBindShadersEXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    commandBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VK_SHADER_STAGE_VERTEX_BIT </span><span class="token operator">|</span><span class="token plain"> VK_SHADER_STAGE_FRAGMENT_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">                </span><span class="token comment" style="color:rgb(98, 114, 164)">// firstBinding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&amp;</span><span class="token plain">vertexShader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// pShaders (按顺序提供每个阶段的 shader)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-设置-pipeline-状态dynamic-state">3. 设置 pipeline 状态（dynamic state）<a href="https://www.iogl.cn/blog/21.shader%20object#3-%E8%AE%BE%E7%BD%AE-pipeline-%E7%8A%B6%E6%80%81dynamic-state" class="hash-link" aria-label="3. 设置 pipeline 状态（dynamic state）的直接链接" title="3. 设置 pipeline 状态（dynamic state）的直接链接">​</a></h3>
<p>Shader Object 不绑定 pipeline，所以你必须通过命令设置 pipeline 动态状态（rasterization, blend, topology 等）：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">vkCmdSetRasterizerDiscardEnable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VK_FALSE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdSetDepthTestEnable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VK_TRUE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdSetPrimitiveTopology</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VK_PRIMITIVE_TOPOLOGY_TRIANGLE_LIST</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdSetViewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">viewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdSetScissor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">scissor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>所有 <code>VK_DYNAMIC_STATE_*</code> 都需要设置，否则行为未定义！</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-资源绑定descriptor-sets">4. 资源绑定（Descriptor Sets）<a href="https://www.iogl.cn/blog/21.shader%20object#4-%E8%B5%84%E6%BA%90%E7%BB%91%E5%AE%9Adescriptor-sets" class="hash-link" aria-label="4. 资源绑定（Descriptor Sets）的直接链接" title="4. 资源绑定（Descriptor Sets）的直接链接">​</a></h3>
<p>仍然使用传统 <code>vkCmdBindDescriptorSets</code> 方式来绑定资源（uniforms, textures 等）：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">vkCmdBindDescriptorSets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    cmd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VK_PIPELINE_BIND_POINT_GRAPHICS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pipelineLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">descriptorSet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-销毁-shader">5. 销毁 Shader<a href="https://www.iogl.cn/blog/21.shader%20object#5-%E9%94%80%E6%AF%81-shader" class="hash-link" aria-label="5. 销毁 Shader的直接链接" title="5. 销毁 Shader的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">vkDestroyShaderEXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> shader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">📦示例代码<a href="https://www.iogl.cn/blog/21.shader%20object#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="📦示例代码的直接链接" title="📦示例代码的直接链接">​</a></h2>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;vulkan/vulkan.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;cassert&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;cstring&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;vector&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;iostream&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 这里假定你已有方式加载或嵌入 SPIR-V 二进制代码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 这里使用伪数据，实际使用时请加载有效的 SPIR-V 数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">vector</span><span class="token operator">&lt;</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token operator">&gt;</span><span class="token plain"> vertexShaderSPIRV </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token comment" style="color:rgb(98, 114, 164)">/* ... Vertex SPIR-V 字节码 ... */</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">vector</span><span class="token operator">&lt;</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token operator">&gt;</span><span class="token plain"> fragmentShaderSPIRV </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token comment" style="color:rgb(98, 114, 164)">/* ... Fragment SPIR-V 字节码 ... */</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 简单的错误处理宏</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">result</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression"> </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">assert</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">result</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression"> </span><span class="token macro property expression operator">==</span><span class="token macro property expression"> VK_SUCCESS</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 伪函数：创建 Vulkan instance、device、command pool 等</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 这里只给出简略流程，实际工程需要完整初始化代码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token class-name">VulkanContext</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkInstance instance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkPhysicalDevice physicalDevice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkDevice device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkQueue graphicsQueue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkCommandPool commandPool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 其它成员如交换链、呈现目标 imageView 等（本示例中用作 dynamic rendering 目标）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VulkanContext </span><span class="token function" style="color:rgb(80, 250, 123)">initVulkan</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VulkanContext ctx </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 创建 instance (确保启用 VK_KHR_dynamic_rendering 扩展) ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">char</span><span class="token operator">*</span><span class="token plain"> instanceExtensions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">"VK_KHR_surface"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">"VK_KHR_win32_surface"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 例如 Windows 平台</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// 其它平台请选择对应扩展</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkApplicationInfo appInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    appInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_APPLICATION_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    appInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pApplicationName   </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"ShaderObjectTriangle"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    appInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">applicationVersion </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">VK_MAKE_VERSION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    appInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pEngineName        </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"None"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    appInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">engineVersion      </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">VK_MAKE_VERSION</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    appInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">apiVersion         </span><span class="token operator">=</span><span class="token plain"> VK_API_VERSION_1_3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 或 Vulkan 1.2 加扩展</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkInstanceCreateInfo instCreateInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    instCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    instCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pApplicationInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">appInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    instCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">enabledExtensionCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">instanceExtensions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">instanceExtensions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    instCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ppEnabledExtensionNames </span><span class="token operator">=</span><span class="token plain"> instanceExtensions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkCreateInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">&amp;</span><span class="token plain">instCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">instance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 选择物理设备，并创建逻辑设备 ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token plain"> gpuCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkEnumeratePhysicalDevices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">instance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">gpuCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">assert</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gpuCount </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">vector</span><span class="token operator">&lt;</span><span class="token plain">VkPhysicalDevice</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gpuCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkEnumeratePhysicalDevices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">instance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">gpuCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">physicalDevice </span><span class="token operator">=</span><span class="token plain"> devices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 简单选择第一个</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 启用需要的 device 扩展：动态渲染 &amp; shader object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">char</span><span class="token operator">*</span><span class="token plain"> deviceExtensions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">"VK_KHR_dynamic_rendering"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token string" style="color:rgb(255, 121, 198)">"VK_EXT_shader_object"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">float</span><span class="token plain"> queuePriority </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkDeviceQueueCreateInfo queueCreateInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    queueCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_DEVICE_QUEUE_CREATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    queueCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">queueFamilyIndex </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 此处假定 family 0 支持图形</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    queueCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">queueCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    queueCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pQueuePriorities </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">queuePriority</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkPhysicalDeviceFeatures deviceFeatures </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkDeviceCreateInfo devCreateInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    devCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_DEVICE_CREATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    devCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">queueCreateInfoCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    devCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pQueueCreateInfos </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">queueCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    devCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">enabledExtensionCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    devCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ppEnabledExtensionNames </span><span class="token operator">=</span><span class="token plain"> deviceExtensions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    devCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pEnabledFeatures </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">deviceFeatures</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkCreateDevice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">physicalDevice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">devCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkGetDeviceQueue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">graphicsQueue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 创建 command pool ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkCommandPoolCreateInfo poolInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    poolInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_COMMAND_POOL_CREATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    poolInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">queueFamilyIndex </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    poolInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">flags </span><span class="token operator">=</span><span class="token plain"> VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkCreateCommandPool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">poolInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">commandPool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 主函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VulkanContext ctx </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">initVulkan</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 获取 VK_EXT_shader_object 的函数指针</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">auto</span><span class="token plain"> vkCreateShadersEXT </span><span class="token operator">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(80, 250, 123)">reinterpret_cast</span><span class="token generic-function generic class-name operator">&lt;</span><span class="token generic-function generic class-name">PFN_vkCreateShadersEXT</span><span class="token generic-function generic class-name operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">vkGetDeviceProcAddr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"vkCreateShadersEXT"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">auto</span><span class="token plain"> vkCmdBindShadersEXT </span><span class="token operator">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(80, 250, 123)">reinterpret_cast</span><span class="token generic-function generic class-name operator">&lt;</span><span class="token generic-function generic class-name">PFN_vkCmdBindShadersEXT</span><span class="token generic-function generic class-name operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">vkGetDeviceProcAddr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"vkCmdBindShadersEXT"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">auto</span><span class="token plain"> vkDestroyShaderEXT </span><span class="token operator">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(80, 250, 123)">reinterpret_cast</span><span class="token generic-function generic class-name operator">&lt;</span><span class="token generic-function generic class-name">PFN_vkDestroyShaderEXT</span><span class="token generic-function generic class-name operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">vkGetDeviceProcAddr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"vkDestroyShaderEXT"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">assert</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">vkCreateShadersEXT </span><span class="token operator">&amp;&amp;</span><span class="token plain"> vkCmdBindShadersEXT </span><span class="token operator">&amp;&amp;</span><span class="token plain"> vkDestroyShaderEXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 创建 Shader Object ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkShaderEXT vertexShader </span><span class="token operator">=</span><span class="token plain"> VK_NULL_HANDLE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkShaderEXT fragmentShader </span><span class="token operator">=</span><span class="token plain"> VK_NULL_HANDLE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 配置顶点着色器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkShaderCreateInfoEXT vertexShaderInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vertexShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType      </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_SHADER_CREATE_INFO_EXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vertexShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">stage      </span><span class="token operator">=</span><span class="token plain"> VK_SHADER_STAGE_VERTEX_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vertexShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">codeType   </span><span class="token operator">=</span><span class="token plain"> VK_SHADER_CODE_TYPE_SPIRV_EXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vertexShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pCode      </span><span class="token operator">=</span><span class="token plain"> vertexShaderSPIRV</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vertexShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">codeSize   </span><span class="token operator">=</span><span class="token plain"> vertexShaderSPIRV</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vertexShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pName      </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"main"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// entry point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkCreateShadersEXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">vertexShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">vertexShader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 配置片元着色器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkShaderCreateInfoEXT fragmentShaderInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fragmentShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType    </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_SHADER_CREATE_INFO_EXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fragmentShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">stage    </span><span class="token operator">=</span><span class="token plain"> VK_SHADER_STAGE_FRAGMENT_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fragmentShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">codeType </span><span class="token operator">=</span><span class="token plain"> VK_SHADER_CODE_TYPE_SPIRV_EXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fragmentShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pCode    </span><span class="token operator">=</span><span class="token plain"> fragmentShaderSPIRV</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fragmentShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">codeSize </span><span class="token operator">=</span><span class="token plain"> fragmentShaderSPIRV</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fragmentShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pName    </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"main"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// entry point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkCreateShadersEXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">fragmentShaderInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">fragmentShader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 创建 Command Buffer ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkCommandBufferAllocateInfo allocInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    allocInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType              </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_COMMAND_BUFFER_ALLOCATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    allocInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">commandPool        </span><span class="token operator">=</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">commandPool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    allocInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">level              </span><span class="token operator">=</span><span class="token plain"> VK_COMMAND_BUFFER_LEVEL_PRIMARY</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    allocInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">commandBufferCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkCommandBuffer cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkAllocateCommandBuffers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">allocInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 开始录制命令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkCommandBufferBeginInfo beginInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    beginInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_COMMAND_BUFFER_BEGIN_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkBeginCommandBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">beginInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 动态渲染设置 ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 假定我们已经创建了一个目标 color image 和 image view（renderTargetView）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 这里为示例使用伪变量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkImageView renderTargetView </span><span class="token operator">=</span><span class="token plain"> VK_NULL_HANDLE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 实际代码中应为有效的 VkImageView</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkExtent2D renderExtent </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token number">800</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">600</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 示例窗口尺寸</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkRenderingAttachmentInfo colorAttachment </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType         </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_RENDERING_ATTACHMENT_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imageView     </span><span class="token operator">=</span><span class="token plain"> renderTargetView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imageLayout   </span><span class="token operator">=</span><span class="token plain"> VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">loadOp        </span><span class="token operator">=</span><span class="token plain"> VK_ATTACHMENT_LOAD_OP_CLEAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">storeOp       </span><span class="token operator">=</span><span class="token plain"> VK_ATTACHMENT_STORE_OP_STORE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">clearValue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">float32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">clearValue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">float32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">clearValue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">float32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">clearValue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">float32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkRenderingInfo renderingInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    renderingInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType                 </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_RENDERING_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    renderingInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">renderArea</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">offset     </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    renderingInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">renderArea</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">extent     </span><span class="token operator">=</span><span class="token plain"> renderExtent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    renderingInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layerCount            </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    renderingInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">colorAttachmentCount  </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    renderingInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pColorAttachments     </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">colorAttachment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 本例不使用深度/模板，因此 pDepthAttachment 和 pStencilAttachment 为 nullptr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 开始动态渲染</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdBeginRendering</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">renderingInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 绑定 Shader Objects ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 为顶点和片元阶段分别绑定 shader object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkShaderEXT shaders</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> vertexShader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> fragmentShader </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// stageFlags 指定需要绑定的 shader 阶段（本例为顶点和片元）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkShaderStageFlags stageFlags </span><span class="token operator">=</span><span class="token plain"> VK_SHADER_STAGE_VERTEX_BIT </span><span class="token operator">|</span><span class="token plain"> VK_SHADER_STAGE_FRAGMENT_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// firstBinding 可设置为 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdBindShadersEXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> stageFlags</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> shaders</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 设置动态状态 ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkViewport viewport </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    viewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">x        </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    viewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">y        </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    viewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">width    </span><span class="token operator">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(80, 250, 123)">static_cast</span><span class="token generic-function generic class-name operator">&lt;</span><span class="token generic-function generic class-name keyword" style="color:rgb(189, 147, 249);font-style:italic">float</span><span class="token generic-function generic class-name operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">renderExtent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">width</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    viewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">height   </span><span class="token operator">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(80, 250, 123)">static_cast</span><span class="token generic-function generic class-name operator">&lt;</span><span class="token generic-function generic class-name keyword" style="color:rgb(189, 147, 249);font-style:italic">float</span><span class="token generic-function generic class-name operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">renderExtent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">height</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    viewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">minDepth </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    viewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">maxDepth </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdSetViewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">viewport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkRect2D scissor </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    scissor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">offset </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    scissor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">extent </span><span class="token operator">=</span><span class="token plain"> renderExtent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdSetScissor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">scissor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 此外，你可能需要设置其它动态状态（例如混合、光栅化状态等），视你的渲染需要而定</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 绘制三角形 ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 此处未绑定 vertex buffers，假设 vertex shader 内部生成顶点数据（使用内置变量或其他技术）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 最简单的情况直接发起 3 个顶点的 draw 调用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdDraw</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 结束动态渲染</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdEndRendering</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 结束命令缓冲录制</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkEndCommandBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 提交命令缓冲并等待执行完成 ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkSubmitInfo submitInfo </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    submitInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType              </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_SUBMIT_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    submitInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">commandBufferCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    submitInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pCommandBuffers    </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cmdBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkQueueSubmit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">graphicsQueue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">submitInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VK_NULL_HANDLE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">VK_CHECK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">vkQueueWaitIdle</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">graphicsQueue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ── 清理 Shader Objects 及其它资源 ──</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkDestroyShaderEXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> vertexShader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkDestroyShaderEXT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> fragmentShader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 清理其它 Vulkan 对象（command pool、device、instance 等）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkDestroyCommandPool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">commandPool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkDestroyDevice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">vkDestroyInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">instance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">nullptr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">cout </span><span class="token operator">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Shader Object Triangle rendered successfully.\n"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[VkPhysicalDeviceFeatures 全字段详解]]></title>
        <id>https://www.iogl.cn/blog/19.physical device features</id>
        <link href="https://www.iogl.cn/blog/19.physical device features"/>
        <updated>2025-07-02T15:22:40.000Z</updated>
        <summary type="html"><![CDATA[VkPhysicalDeviceFeatures 全字段详解]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vkphysicaldevicefeatures-全字段详解"><code>VkPhysicalDeviceFeatures</code> 全字段详解<a href="https://www.iogl.cn/blog/19.physical%20device%20features#vkphysicaldevicefeatures-%E5%85%A8%E5%AD%97%E6%AE%B5%E8%AF%A6%E8%A7%A3" class="hash-link" aria-label="vkphysicaldevicefeatures-全字段详解的直接链接" title="vkphysicaldevicefeatures-全字段详解的直接链接">​</a></h2>
<table><thead><tr><th>字段名</th><th>中文解释</th><th>功能描述</th><th>建议启用</th></tr></thead><tbody><tr><td><code>robustBufferAccess</code></td><td>可靠缓冲访问</td><td>防止越界读取 buffer（安全性高，性能略降）</td><td>✅ 建议启用</td></tr><tr><td><code>fullDrawIndexUint32</code></td><td>完整 32 位索引</td><td>支持 uint32_t 顶点索引（&gt; 65535）</td><td>✅ 建议启用</td></tr><tr><td><code>imageCubeArray</code></td><td>立方体贴图数组</td><td>支持 <code>cube[]</code> 类型纹理数组（天空盒、PBR）</td><td>✅ 常用</td></tr><tr><td><code>independentBlend</code></td><td>独立混合</td><td>framebuffer 中每个颜色附件独立设置混合参数</td><td>✅ 多渲染目标</td></tr><tr><td><code>geometryShader</code></td><td>几何着色器</td><td>支持 geometry shader 阶段</td><td>✅ 若用</td></tr><tr><td><code>tessellationShader</code></td><td>曲面细分着色器</td><td>支持 tessellation shader 阶段</td><td>✅ 若用</td></tr><tr><td><code>sampleRateShading</code></td><td>每采样着色</td><td>支持 MSAA 中 per-sample 着色</td><td>✅ 若做 MSAA</td></tr><tr><td><code>dualSrcBlend</code></td><td>双源混合</td><td>Fragment Shader 可输出两种颜色供混合使用</td><td>⚠️ 特殊需求</td></tr><tr><td><code>logicOp</code></td><td>逻辑操作混合</td><td>支持逻辑运算混合（AND, OR, XOR）</td><td>❌ 少用</td></tr><tr><td><code>multiDrawIndirect</code></td><td>多重绘制（间接）</td><td><code>vkCmdDrawIndirect()</code> 可一次提交多个 draw</td><td>✅ 批处理优化</td></tr><tr><td><code>drawIndirectFirstInstance</code></td><td>支持 firstInstance 参数</td><td><code>vkCmdDrawIndirect()</code> 支持 firstInstance &gt; 0</td><td>✅ 现代渲染常用</td></tr><tr><td><code>depthClamp</code></td><td>深度裁剪</td><td>替代剪裁 -1~1 范围（保持 z 方向顶点）</td><td>✅ 阴影场景常用</td></tr><tr><td><code>depthBiasClamp</code></td><td>深度偏移裁剪</td><td>防止 bias 偏移过多导致错误</td><td>✅ 阴影贴图常用</td></tr><tr><td><code>fillModeNonSolid</code></td><td>非填充模式</td><td>支持线框/点渲染（wireframe/points）</td><td>✅ 调试用</td></tr><tr><td><code>depthBounds</code></td><td>深度边界测试</td><td>允许指定深度范围进行测试（优化）</td><td>⚠️ 受限支持</td></tr><tr><td><code>wideLines</code></td><td>宽线支持</td><td>支持 &gt;1 像素的线条宽度</td><td>⚠️ 移动端大多不支持</td></tr><tr><td><code>largePoints</code></td><td>大点支持</td><td>点精灵支持大尺寸</td><td>✅ 少量使用</td></tr><tr><td><code>alphaToOne</code></td><td>alphaToOne</td><td>支持将 fragment alpha 强制设置为 1.0</td><td>⚠️ 透明排序时可用</td></tr><tr><td><code>multiViewport</code></td><td>多视口</td><td>支持一次绘制多个视口（VR、多屏）</td><td>✅ 多摄像头渲染</td></tr><tr><td><code>samplerAnisotropy</code></td><td>各向异性过滤</td><td>提高纹理在斜角处的清晰度</td><td>✅ 强烈建议启用</td></tr><tr><td><code>textureCompressionETC2</code></td><td>ETC2 压缩纹理</td><td>用于移动平台节省显存</td><td>✅ 移动端强烈建议启用</td></tr><tr><td><code>textureCompressionASTC_LDR</code></td><td>ASTC 压缩纹理</td><td>高质量压缩纹理格式</td><td>✅ 若资源用 ASTC</td></tr><tr><td><code>textureCompressionBC</code></td><td>BC压缩纹理</td><td>桌面压缩格式（DXT1~5）</td><td>✅ 桌面平台建议启用</td></tr><tr><td><code>occlusionQueryPrecise</code></td><td>精确遮挡查询</td><td>更高精度的 <code>vkCmdBeginQuery()</code></td><td>⚠️ 若做遮挡剔除</td></tr><tr><td><code>pipelineStatisticsQuery</code></td><td>管线统计查询</td><td>可统计 shader、vertices 等数据</td><td>✅ 性能分析时用</td></tr><tr><td><code>vertexPipelineStoresAndAtomics</code></td><td>顶点阶段写入/原子</td><td>支持在顶点阶段写 SSBO</td><td>✅ 特殊用途如粒子模拟</td></tr><tr><td><code>fragmentStoresAndAtomics</code></td><td>片段阶段写入/原子</td><td>允许 fragment shader 中对 buffer/image 原子操作</td><td>✅ 做累加/排序等用</td></tr><tr><td><code>shaderTessellationAndGeometryPointSize</code></td><td>Tess/Geo 支持点大小</td><td>是否能在 GS/Tess 中设置 gl_PointSize</td><td>⚠️ 特定图元需</td></tr><tr><td><code>shaderImageGatherExtended</code></td><td>扩展 imageGather</td><td>支持更复杂的纹理采样 gather 操作</td><td>✅ 多数现代 GPU 支持</td></tr><tr><td><code>shaderStorageImageExtendedFormats</code></td><td>image 格式扩展</td><td>支持非标准格式的 storage image</td><td>✅ 若用 float16/uint</td></tr><tr><td><code>shaderStorageImageMultisample</code></td><td>多采样 image 支持</td><td>支持对 multisample image 的读写</td><td>✅ 做 MSAA resolve shader 时必需</td></tr><tr><td><code>shaderStorageImageReadWithoutFormat</code></td><td>无格式读取 image</td><td>读 storage image 不需指定格式</td><td>✅ 更灵活</td></tr><tr><td><code>shaderStorageImageWriteWithoutFormat</code></td><td>无格式写入 image</td><td>写 storage image 不需指定格式</td><td>✅ 若写入 raw data</td></tr><tr><td><code>shaderUniformBufferArrayDynamicIndexing</code></td><td>动态索引 UBO 数组</td><td>Shader 支持 runtime 动态访问 uniform 数组</td><td>✅ 常用</td></tr><tr><td><code>shaderSampledImageArrayDynamicIndexing</code></td><td>动态索引 Texture 数组</td><td>Shader 支持 runtime 动态访问纹理数组</td><td>✅ 常用</td></tr><tr><td><code>shaderStorageBufferArrayDynamicIndexing</code></td><td>动态索引 SSBO 数组</td><td>Shader 支持 runtime 动态访问 storage buffer 数组</td><td>✅ 常用</td></tr><tr><td><code>shaderStorageImageArrayDynamicIndexing</code></td><td>动态索引 image 数组</td><td>Shader 支持 runtime 动态访问 image 数组</td><td>✅ 常用</td></tr><tr><td><code>shaderClipDistance</code></td><td>支持 clip distance</td><td>用 gl_ClipDistance 实现自定义裁剪</td><td>✅ 特效需要</td></tr><tr><td><code>shaderCullDistance</code></td><td>支持 cull distance</td><td>提前剔除片段（更省资源）</td><td>✅ 多用于优化</td></tr><tr><td><code>shaderFloat64</code></td><td>double 精度 float</td><td>支持 64 位 float</td><td>⚠️ 少数场合用（科学计算）</td></tr><tr><td><code>shaderInt64</code></td><td>64 位整数</td><td>支持 long 类型 int</td><td>✅ 若 GPU 计算需要</td></tr><tr><td><code>shaderInt16</code></td><td>16 位整数</td><td>支持短整数（需 Vulkan 1.1 或扩展）</td><td>✅ 移动端节省带宽</td></tr><tr><td><code>shaderResourceResidency</code></td><td>资源驻留控制</td><td>用于 bindless resource 管理</td><td>⚠️ 仅 NVIDIA 特性</td></tr><tr><td><code>shaderResourceMinLod</code></td><td>最小 LOD 控制</td><td>更细粒度的 mip 控制</td><td>✅ 特效优化</td></tr><tr><td><code>sparseBinding</code></td><td>稀疏资源绑定</td><td>支持虚拟贴图（虚拟内存分页）</td><td>⚠️ 高级用途</td></tr><tr><td><code>sparseResidencyBuffer</code></td><td>稀疏 Buffer</td><td>支持虚拟化 buffer 内存</td><td>⚠️ 少数应用</td></tr><tr><td><code>sparseResidencyImage2D/3D</code></td><td>稀疏图像</td><td>虚拟贴图支持</td><td>⚠️ 高级虚拟纹理系统</td></tr><tr><td><code>sparseResidencyAliased</code></td><td>稀疏别名</td><td>多个资源共享内存页</td><td>⚠️ 专业图形系统用</td></tr><tr><td><code>variableMultisampleRate</code></td><td>可变 MSAA</td><td>每个子通道可以有不同的采样率</td><td>⚠️ 特定场景</td></tr><tr><td><code>inheritedQueries</code></td><td>继承查询支持</td><td>Secondary Command Buffer 继承 query</td><td>✅ 渲染统计需求</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-示例开启特性">📚 示例：开启特性<a href="https://www.iogl.cn/blog/19.physical%20device%20features#-%E7%A4%BA%E4%BE%8B%E5%BC%80%E5%90%AF%E7%89%B9%E6%80%A7" class="hash-link" aria-label="📚 示例：开启特性的直接链接" title="📚 示例：开启特性的直接链接">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//打印支持的特性</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkPhysicalDeviceFeatures features;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkGetPhysicalDeviceFeatures(physicalDevice, &amp;features);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if (features.samplerAnisotropy)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std::cout &lt;&lt; "支持各向异性过滤！" &lt;&lt; std::endl;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if (features.geometryShader)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std::cout &lt;&lt; "支持 Geometry Shader！" &lt;&lt; std::endl;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//开启特性</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkPhysicalDeviceFeatures enabled{};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">enabled.samplerAnisotropy = VK_TRUE;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">enabled.multiDrawIndirect = VK_TRUE;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkDeviceCreateInfo createInfo{};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">createInfo.pEnabledFeatures = &amp;enabled;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCreateDevice(physicalDevice, &amp;createInfo, nullptr, &amp;device);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="图形基础" term="图形基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[多subpass渲染]]></title>
        <id>https://www.iogl.cn/blog/18.multi subpass</id>
        <link href="https://www.iogl.cn/blog/18.multi subpass"/>
        <updated>2025-07-02T10:22:30.000Z</updated>
        <summary type="html"><![CDATA[多 Subpass 的 Vulkan 渲染流程，非常适合用于 G-buffer + 光照、先画再后处理等场景。]]></summary>
        <content type="html"><![CDATA[<p>多 Subpass 的 Vulkan 渲染流程，非常适合用于 G-buffer + 光照、先画再后处理等场景。</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-示例目标">🎯 示例目标<a href="https://www.iogl.cn/blog/18.multi%20subpass#-%E7%A4%BA%E4%BE%8B%E7%9B%AE%E6%A0%87" class="hash-link" aria-label="🎯 示例目标的直接链接" title="🎯 示例目标的直接链接">​</a></h2>
<p>我们构建一个简单的 <strong>双 Subpass Render Pass</strong>：</p>
<ol>
<li><strong>Subpass 0</strong>：绘制场景，输出到颜色附件（Color Attachment 0）</li>
<li><strong>Subpass 1</strong>：对前面的输出做一个后处理，读取 Subpass 0 的颜色作为输入 attachment，再输出到屏幕（Color Attachment 1）</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-涉及的-attachment总共-2-个">✅ 涉及的 Attachment（总共 2 个）<a href="https://www.iogl.cn/blog/18.multi%20subpass#-%E6%B6%89%E5%8F%8A%E7%9A%84-attachment%E6%80%BB%E5%85%B1-2-%E4%B8%AA" class="hash-link" aria-label="✅ 涉及的 Attachment（总共 2 个）的直接链接" title="✅ 涉及的 Attachment（总共 2 个）的直接链接">​</a></h2>
<table><thead><tr><th>Attachment Index</th><th>类型</th><th>用途</th></tr></thead><tbody><tr><td>0</td><td>Color Attachment</td><td>用于 Subpass 0 输出</td></tr><tr><td>1</td><td>Color Attachment</td><td>用于 Subpass 1 输出最终画面</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-步骤总览">🧩 步骤总览<a href="https://www.iogl.cn/blog/18.multi%20subpass#-%E6%AD%A5%E9%AA%A4%E6%80%BB%E8%A7%88" class="hash-link" aria-label="🧩 步骤总览的直接链接" title="🧩 步骤总览的直接链接">​</a></h2>
<ol>
<li>定义两个附件（Attachment 0 和 1）</li>
<li>创建两个 Subpass：<!-- -->
<ul>
<li>Subpass 0：写入 Attachment 0</li>
<li>Subpass 1：读取 Attachment 0，写入 Attachment 1</li>
</ul>
</li>
<li>设置 Subpass Dependency 同步两个阶段</li>
<li>用 <code>vkCmdNextSubpass()</code> 过渡到下一个 subpass</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-代码示例">📜 代码示例<a href="https://www.iogl.cn/blog/18.multi%20subpass#-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" class="hash-link" aria-label="📜 代码示例的直接链接" title="📜 代码示例的直接链接">​</a></h2>
<p>下面是核心结构代码（C++ 伪代码 + Vulkan）：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-定义-attachments">1. 定义 Attachments<a href="https://www.iogl.cn/blog/18.multi%20subpass#1-%E5%AE%9A%E4%B9%89-attachments" class="hash-link" aria-label="1. 定义 Attachments的直接链接" title="1. 定义 Attachments的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkAttachmentDescription attachments[2] = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Attachment 0: Intermediate color output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[0].format = VK_FORMAT_R8G8B8A8_UNORM;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[0].samples = VK_SAMPLE_COUNT_1_BIT;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[0].loadOp = VK_ATTACHMENT_LOAD_OP_CLEAR;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[0].storeOp = VK_ATTACHMENT_STORE_OP_STORE;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[0].initialLayout = VK_IMAGE_LAYOUT_UNDEFINED;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[0].finalLayout = VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Attachment 1: Final output (present)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[1].format = swapchainImageFormat;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[1].samples = VK_SAMPLE_COUNT_1_BIT;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[1].loadOp = VK_ATTACHMENT_LOAD_OP_CLEAR;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[1].storeOp = VK_ATTACHMENT_STORE_OP_STORE;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[1].initialLayout = VK_IMAGE_LAYOUT_UNDEFINED;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">attachments[1].finalLayout = VK_IMAGE_LAYOUT_PRESENT_SRC_KHR;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-定义-subpasses">2. 定义 Subpasses<a href="https://www.iogl.cn/blog/18.multi%20subpass#2-%E5%AE%9A%E4%B9%89-subpasses" class="hash-link" aria-label="2. 定义 Subpasses的直接链接" title="2. 定义 Subpasses的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="subpass-0写入-attachment-0">Subpass 0：写入 Attachment 0<a href="https://www.iogl.cn/blog/18.multi%20subpass#subpass-0%E5%86%99%E5%85%A5-attachment-0" class="hash-link" aria-label="Subpass 0：写入 Attachment 0的直接链接" title="Subpass 0：写入 Attachment 0的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkAttachmentReference colorRef0 = { 0, VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkSubpassDescription subpass0 = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass0.pipelineBindPoint = VK_PIPELINE_BIND_POINT_GRAPHICS;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass0.colorAttachmentCount = 1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass0.pColorAttachments = &amp;colorRef0;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="subpass-1读取-attachment-0-作为输入写入-attachment-1">Subpass 1：读取 Attachment 0 作为输入，写入 Attachment 1<a href="https://www.iogl.cn/blog/18.multi%20subpass#subpass-1%E8%AF%BB%E5%8F%96-attachment-0-%E4%BD%9C%E4%B8%BA%E8%BE%93%E5%85%A5%E5%86%99%E5%85%A5-attachment-1" class="hash-link" aria-label="Subpass 1：读取 Attachment 0 作为输入，写入 Attachment 1的直接链接" title="Subpass 1：读取 Attachment 0 作为输入，写入 Attachment 1的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkAttachmentReference inputRef = { 0, VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkAttachmentReference colorRef1 = { 1, VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkSubpassDescription subpass1 = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass1.pipelineBindPoint = VK_PIPELINE_BIND_POINT_GRAPHICS;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass1.inputAttachmentCount = 1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass1.pInputAttachments = &amp;inputRef;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass1.colorAttachmentCount = 1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass1.pColorAttachments = &amp;colorRef1;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-添加-subpass-依赖同步两个-subpass">3. 添加 Subpass 依赖（同步两个 Subpass）<a href="https://www.iogl.cn/blog/18.multi%20subpass#3-%E6%B7%BB%E5%8A%A0-subpass-%E4%BE%9D%E8%B5%96%E5%90%8C%E6%AD%A5%E4%B8%A4%E4%B8%AA-subpass" class="hash-link" aria-label="3. 添加 Subpass 依赖（同步两个 Subpass）的直接链接" title="3. 添加 Subpass 依赖（同步两个 Subpass）的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkSubpassDependency dependency = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependency.srcSubpass = 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependency.dstSubpass = 1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependency.srcStageMask = VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependency.dstStageMask = VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependency.srcAccessMask = VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependency.dstAccessMask = VK_ACCESS_INPUT_ATTACHMENT_READ_BIT;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-创建-render-pass">4. 创建 Render Pass<a href="https://www.iogl.cn/blog/18.multi%20subpass#4-%E5%88%9B%E5%BB%BA-render-pass" class="hash-link" aria-label="4. 创建 Render Pass的直接链接" title="4. 创建 Render Pass的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkSubpassDescription subpasses[] = { subpass0, subpass1 };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkRenderPassCreateInfo renderPassInfo{};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">renderPassInfo.sType = VK_STRUCTURE_TYPE_RENDER_PASS_CREATE_INFO;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">renderPassInfo.attachmentCount = 2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">renderPassInfo.pAttachments = attachments;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">renderPassInfo.subpassCount = 2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">renderPassInfo.pSubpasses = subpasses;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">renderPassInfo.dependencyCount = 1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">renderPassInfo.pDependencies = &amp;dependency;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkRenderPass renderPass;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCreateRenderPass(device, &amp;renderPassInfo, nullptr, &amp;renderPass);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-在-command-buffer-中使用">5. 在 Command Buffer 中使用<a href="https://www.iogl.cn/blog/18.multi%20subpass#5-%E5%9C%A8-command-buffer-%E4%B8%AD%E4%BD%BF%E7%94%A8" class="hash-link" aria-label="5. 在 Command Buffer 中使用的直接链接" title="5. 在 Command Buffer 中使用的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑vkCmdBeginRenderPass(cmdBuffer, &amp;renderPassBeginInfo, VK_SUBPASS_CONTENTS_INLINE);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// --- Subpass 0 ---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdBindPipeline(cmdBuffer, ..., pipeline0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdDraw(cmdBuffer, ...);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 切换到 Subpass 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdNextSubpass(cmdBuffer, VK_SUBPASS_CONTENTS_INLINE);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// --- Subpass 1 ---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdBindPipeline(cmdBuffer, ..., pipeline1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdDraw(cmdBuffer, ...);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkCmdEndRenderPass(cmdBuffer);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-附加说明">📦 附加说明<a href="https://www.iogl.cn/blog/18.multi%20subpass#-%E9%99%84%E5%8A%A0%E8%AF%B4%E6%98%8E" class="hash-link" aria-label="📦 附加说明的直接链接" title="📦 附加说明的直接链接">​</a></h2>
<table><thead><tr><th>名称</th><th>说明</th></tr></thead><tbody><tr><td><code>vkCmdNextSubpass()</code></td><td>明确切换到下一个 Subpass</td></tr><tr><td><code>input attachment</code></td><td>只允许当前 framebuffer 的 image 作只读使用</td></tr><tr><td>Pipeline layout</td><td>Subpass 1 的 fragment shader 中用 <code>inputAttachment</code> 读取 Subpass 0 的结果</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-shader-中如何读取上一个-subpass-的结果">🧠 Shader 中如何读取上一个 Subpass 的结果？<a href="https://www.iogl.cn/blog/18.multi%20subpass#-shader-%E4%B8%AD%E5%A6%82%E4%BD%95%E8%AF%BB%E5%8F%96%E4%B8%8A%E4%B8%80%E4%B8%AA-subpass-%E7%9A%84%E7%BB%93%E6%9E%9C" class="hash-link" aria-label="🧠 Shader 中如何读取上一个 Subpass 的结果？的直接链接" title="🧠 Shader 中如何读取上一个 Subpass 的结果？的直接链接">​</a></h2>
<p>在 Subpass 1 的 Fragment Shader：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">glsl复制编辑layout (input_attachment_index = 0, set = 0, binding = 0) uniform subpassInput inputColor;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void main() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vec4 color = subpassLoad(inputColor);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 做一些后处理操作</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-总结">✅ 总结<a href="https://www.iogl.cn/blog/18.multi%20subpass#-%E6%80%BB%E7%BB%93" class="hash-link" aria-label="✅ 总结的直接链接" title="✅ 总结的直接链接">​</a></h2>
<table><thead><tr><th>步骤</th><th>动作</th></tr></thead><tbody><tr><td>定义多个 attachment</td><td>描述 color / depth 输出</td></tr><tr><td>创建多个 subpass</td><td>指定谁写、谁读</td></tr><tr><td>设置 dependency</td><td>明确读写先后顺序</td></tr><tr><td><code>vkCmdNextSubpass</code></td><td>切换阶段</td></tr></tbody></table>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="图形基础" term="图形基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[vulkan中的MSAA resolvemode]]></title>
        <id>https://www.iogl.cn/blog/17.vulkan_msaa_resolvemode</id>
        <link href="https://www.iogl.cn/blog/17.vulkan_msaa_resolvemode"/>
        <updated>2025-03-01T17:49:18.000Z</updated>
        <summary type="html"><![CDATA[VKRESOLVEMODEAVERAGEBIT 是 Vulkan 多重采样抗锯齿（MSAA） 解析（resolve）操作的一种模式，它的作用是 对多个采样点的颜色值求平均，然后将结果存储到解析目标（resolve attachment）中。]]></summary>
        <content type="html"><![CDATA[<p><code>VK_RESOLVE_MODE_AVERAGE_BIT</code> 是 Vulkan <strong>多重采样抗锯齿（MSAA）</strong> 解析（resolve）操作的一种模式，它的作用是 <strong>对多个采样点的颜色值求平均</strong>，然后将结果存储到解析目标（resolve attachment）中。</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-为什么需要-vk_resolve_mode_average_bit"><strong>1. 为什么需要 <code>VK_RESOLVE_MODE_AVERAGE_BIT</code>？</strong><a href="https://www.iogl.cn/blog/17.vulkan_msaa_resolvemode#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-vk_resolve_mode_average_bit" class="hash-link" aria-label="1-为什么需要-vk_resolve_mode_average_bit的直接链接" title="1-为什么需要-vk_resolve_mode_average_bit的直接链接">​</a></h2>
<p>在 <strong>MSAA</strong> 渲染过程中，每个像素具有多个子采样点（multi-sample points），但最终屏幕只能显示一个颜色值。因此，在 <strong>MSAA 解析阶段</strong>（resolve），需要将 <strong>多采样颜色缓冲转换为单采样缓冲</strong>，这通常会使用 <strong>解析模式（resolve mode）</strong> 来决定如何计算最终颜色。</p>
<p><code>VK_RESOLVE_MODE_AVERAGE_BIT</code> 具体作用：</p>
<ul>
<li><strong>对所有采样点的颜色值求平均</strong>，得到一个平滑过渡的最终颜色。</li>
<li><strong>适用于颜色缓冲的解析（color resolve）</strong>，减少因抗锯齿带来的边缘锐度损失。</li>
<li><strong>提高视觉平滑度</strong>，尤其适用于高对比度的边缘。</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-代码示例"><strong>2. 代码示例</strong><a href="https://www.iogl.cn/blog/17.vulkan_msaa_resolvemode#2-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" class="hash-link" aria-label="2-代码示例的直接链接" title="2-代码示例的直接链接">​</a></h2>
<p>在 Vulkan 创建 <strong>多采样颜色缓冲（MSAA color attachment）</strong> 并解析时，可以这样设置：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkSubpassDescription subpass = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass.colorAttachmentCount = 1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass.pColorAttachments = &amp;colorAttachmentRef;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass.pResolveAttachments = &amp;resolveAttachmentRef;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>指定 <code>VK_RESOLVE_MODE_AVERAGE_BIT</code> 解析模式：</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkSubpassDescription2 subpass = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass.pResolveAttachments = &amp;resolveAttachmentRef;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkAttachmentDescription2 resolveAttachment = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachment.format = VK_FORMAT_R8G8B8A8_UNORM;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachment.samples = VK_SAMPLE_COUNT_1_BIT;  // 解析到单采样</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachment.loadOp = VK_ATTACHMENT_LOAD_OP_DONT_CARE;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachment.storeOp = VK_ATTACHMENT_STORE_OP_STORE;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachment.initialLayout = VK_IMAGE_LAYOUT_UNDEFINED;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachment.finalLayout = VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkAttachmentReference2 resolveAttachmentRef = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachmentRef.attachment = 1;  // 解析附件索引</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachmentRef.layout = VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachmentRef.resolveMode = VK_RESOLVE_MODE_AVERAGE_BIT;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-vk_resolve_mode_average_bit-vs-其他解析模式"><strong>3. <code>VK_RESOLVE_MODE_AVERAGE_BIT</code> vs. 其他解析模式</strong><a href="https://www.iogl.cn/blog/17.vulkan_msaa_resolvemode#3-vk_resolve_mode_average_bit-vs-%E5%85%B6%E4%BB%96%E8%A7%A3%E6%9E%90%E6%A8%A1%E5%BC%8F" class="hash-link" aria-label="3-vk_resolve_mode_average_bit-vs-其他解析模式的直接链接" title="3-vk_resolve_mode_average_bit-vs-其他解析模式的直接链接">​</a></h2>
<p>Vulkan 提供了多种解析模式，每种适用于不同的渲染需求：</p>
<table><thead><tr><th><strong>解析模式</strong></th><th><strong>作用</strong></th></tr></thead><tbody><tr><td><code>VK_RESOLVE_MODE_NONE</code></td><td>不进行解析</td></tr><tr><td><code>VK_RESOLVE_MODE_SAMPLE_ZERO_BIT</code></td><td>直接选取第一个采样点的值</td></tr><tr><td><code>VK_RESOLVE_MODE_AVERAGE_BIT</code></td><td><strong>计算所有采样点的平均值</strong>（常用于颜色缓冲解析）</td></tr><tr><td><code>VK_RESOLVE_MODE_MIN_BIT</code></td><td>选取最小颜色值（适用于深度缓冲解析）</td></tr><tr><td><code>VK_RESOLVE_MODE_MAX_BIT</code></td><td>选取最大颜色值（适用于深度缓冲解析）</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-适用场景"><strong>4. 适用场景</strong><a href="https://www.iogl.cn/blog/17.vulkan_msaa_resolvemode#4-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF" class="hash-link" aria-label="4-适用场景的直接链接" title="4-适用场景的直接链接">​</a></h2>
<p>✅ <strong>适合颜色缓冲的解析</strong></p>
<ul>
<li>适用于 MSAA <strong>颜色附件（color attachment）</strong> 解析，使得边缘更平滑。</li>
<li>对 <strong>HDR 渲染</strong> 也适用，可防止过度锐化的现象。</li>
</ul>
<p>❌ <strong>不适用于深度/模版缓冲</strong></p>
<ul>
<li>深度缓冲通常用 <code>VK_RESOLVE_MODE_MIN_BIT</code> 或 <code>VK_RESOLVE_MODE_MAX_BIT</code>，而不是 <code>VK_RESOLVE_MODE_AVERAGE_BIT</code>，因为深度值不能简单平均。</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-总结"><strong>5. 总结</strong><a href="https://www.iogl.cn/blog/17.vulkan_msaa_resolvemode#5-%E6%80%BB%E7%BB%93" class="hash-link" aria-label="5-总结的直接链接" title="5-总结的直接链接">​</a></h2>
<ul>
<li><code>VK_RESOLVE_MODE_AVERAGE_BIT</code> <strong>用于 MSAA 解析（resolve）时计算采样点的平均颜色值</strong>。</li>
<li><strong>适用于颜色缓冲（color attachments），可减少锯齿，提高画面平滑度</strong>。</li>
<li><strong>不适用于深度/模板缓冲（depth/stencil attachments）</strong>，因为深度解析通常需要最小值或最大值，而非平均值。</li>
</ul>
<p>🚀 <strong>如果你的 Vulkan 应用使用 MSAA，并希望平滑过渡颜色缓冲，<code>VK_RESOLVE_MODE_AVERAGE_BIT</code> 是推荐的解析模式！</strong></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="图形基础" term="图形基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[什么是MSAA]]></title>
        <id>https://www.iogl.cn/blog/16.msaa</id>
        <link href="https://www.iogl.cn/blog/16.msaa"/>
        <updated>2025-02-28T15:47:18.000Z</updated>
        <summary type="html"><![CDATA[MSAA（Multisample Anti-Aliasing，多重采样抗锯齿） 是一种 硬件级别的抗锯齿技术，用于减少 3D 渲染中的 锯齿效应（aliasing），特别是在 边缘平滑处理 方面效果显著。]]></summary>
        <content type="html"><![CDATA[<p><strong>MSAA（Multisample Anti-Aliasing，多重采样抗锯齿）</strong> 是一种 <strong>硬件级别的抗锯齿技术</strong>，用于减少 3D 渲染中的 <strong>锯齿效应（aliasing）</strong>，特别是在 <strong>边缘平滑处理</strong> 方面效果显著。</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-为什么需要-msaa抗锯齿的必要性"><strong>1. 为什么需要 MSAA？（抗锯齿的必要性）</strong><a href="https://www.iogl.cn/blog/16.msaa#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-msaa%E6%8A%97%E9%94%AF%E9%BD%BF%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7" class="hash-link" aria-label="1-为什么需要-msaa抗锯齿的必要性的直接链接" title="1-为什么需要-msaa抗锯齿的必要性的直接链接">​</a></h2>
<p>在计算机图形学中，<strong>像素是离散的</strong>，而 3D 场景中的物体边缘通常是连续的。当我们将连续的几何边缘映射到有限的像素网格时，会出现<strong>锯齿效应</strong>（aliasing），如下所示：</p>
<p>🔳 <strong>没有抗锯齿的图像：</strong></p>
<ul>
<li>物体边缘呈现 <strong>台阶状的锯齿</strong>，影响视觉质量。</li>
<li>这是因为 <strong>每个像素只能存储一个颜色值</strong>，当边缘落在两个像素之间时，颜色会出现不连续的跳变。</li>
</ul>
<p><strong>✅ 抗锯齿后：</strong></p>
<ul>
<li>通过<strong>颜色混合</strong>技术，边缘过渡更加平滑。</li>
<li>MSAA 通过 <strong>在每个像素中增加多个采样点</strong>，并计算加权平均值，从而减少锯齿。</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-msaa-的基本原理"><strong>2. MSAA 的基本原理</strong><a href="https://www.iogl.cn/blog/16.msaa#2-msaa-%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86" class="hash-link" aria-label="2-msaa-的基本原理的直接链接" title="2-msaa-的基本原理的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="普通渲染-vs-msaa"><strong>普通渲染 vs MSAA</strong><a href="https://www.iogl.cn/blog/16.msaa#%E6%99%AE%E9%80%9A%E6%B8%B2%E6%9F%93-vs-msaa" class="hash-link" aria-label="普通渲染-vs-msaa的直接链接" title="普通渲染-vs-msaa的直接链接">​</a></h3>
<table><thead><tr><th><strong>方法</strong></th><th><strong>像素采样方式</strong></th><th><strong>效果</strong></th></tr></thead><tbody><tr><td><strong>普通渲染</strong></td><td>1 个像素 → 1 个颜色样本</td><td>🚫 锯齿明显</td></tr><tr><td><strong>MSAA (4x)</strong></td><td>1 个像素 → 4 个采样点，每个采样点有深度信息，但颜色只计算一次</td><td>✅ 平滑</td></tr></tbody></table>
<p>🔹 <strong>MSAA 的核心思想：</strong></p>
<ol>
<li><strong>每个像素的多个子采样点（Subsample Points）独立存储深度信息</strong>。</li>
<li><strong>当片段着色器（Fragment Shader）运行时，它只计算一次颜色</strong>，但最终的颜色会根据哪些子采样点被覆盖进行混合。</li>
<li><strong>最终像素颜色是所有子采样点的加权平均值</strong>，从而实现平滑过渡。</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-msaa-的不同级别"><strong>3. MSAA 的不同级别</strong><a href="https://www.iogl.cn/blog/16.msaa#3-msaa-%E7%9A%84%E4%B8%8D%E5%90%8C%E7%BA%A7%E5%88%AB" class="hash-link" aria-label="3-msaa-的不同级别的直接链接" title="3-msaa-的不同级别的直接链接">​</a></h2>
<p>MSAA 的性能开销与采样点数量成正比，常见的 MSAA 级别有：</p>
<table><thead><tr><th><strong>MSAA 级别</strong></th><th><strong>每像素采样点数</strong></th><th><strong>性能开销</strong></th><th><strong>效果</strong></th></tr></thead><tbody><tr><td><strong>1x</strong> （无 MSAA）</td><td>1</td><td>低</td><td>🚫 锯齿明显</td></tr><tr><td><strong>2x MSAA</strong></td><td>2</td><td>适中</td><td>🔹 有一定平滑效果</td></tr><tr><td><strong>4x MSAA</strong></td><td>4</td><td>中等</td><td>✅ 常见，效果明显</td></tr><tr><td><strong>8x MSAA</strong></td><td>8</td><td>高</td><td>🔥 画质好但性能开销大</td></tr><tr><td><strong>16x MSAA</strong></td><td>16</td><td>很高</td><td>🎨 非常平滑，但计算量大</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="示例不同-msaa-级别对比"><strong>示例：不同 MSAA 级别对比</strong><a href="https://www.iogl.cn/blog/16.msaa#%E7%A4%BA%E4%BE%8B%E4%B8%8D%E5%90%8C-msaa-%E7%BA%A7%E5%88%AB%E5%AF%B9%E6%AF%94" class="hash-link" aria-label="示例不同-msaa-级别对比的直接链接" title="示例不同-msaa-级别对比的直接链接">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">scss复制编辑[1x MSAA]  ████■■■■████     (严重锯齿)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2x MSAA]  ████▒▒▒▒████     (稍微平滑)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[4x MSAA]  ████░░░░████     (明显平滑)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[8x MSAA]  ████░░░░████     (非常平滑)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>高 MSAA</strong> 提供更好的边缘平滑效果，但也增加了 GPU 计算负担。</li>
<li><strong>一般游戏或应用常用 4x MSAA 作为折中方案</strong>。</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-vulkan-中的-msaa"><strong>4. Vulkan 中的 MSAA</strong><a href="https://www.iogl.cn/blog/16.msaa#4-vulkan-%E4%B8%AD%E7%9A%84-msaa" class="hash-link" aria-label="4-vulkan-中的-msaa的直接链接" title="4-vulkan-中的-msaa的直接链接">​</a></h2>
<p>在 Vulkan 里，<strong>MSAA 通过 <code>VkSampleCountFlagBits</code> 设置采样数量</strong>：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">复制编辑</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkSampleCountFlagBits msaaSamples = VK_SAMPLE_COUNT_4_BIT; // 4x MSAA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="在-vulkan-创建-msaa-颜色缓冲"><strong>在 Vulkan 创建 MSAA 颜色缓冲</strong><a href="https://www.iogl.cn/blog/16.msaa#%E5%9C%A8-vulkan-%E5%88%9B%E5%BB%BA-msaa-%E9%A2%9C%E8%89%B2%E7%BC%93%E5%86%B2" class="hash-link" aria-label="在-vulkan-创建-msaa-颜色缓冲的直接链接" title="在-vulkan-创建-msaa-颜色缓冲的直接链接">​</a></h3>
<ul>
<li><strong>颜色附件（Color Attachment）</strong> 需要使用多采样：</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkAttachmentDescription colorAttachment = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">colorAttachment.samples = VK_SAMPLE_COUNT_4_BIT; // 使用 4x MSAA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>解析附件（Resolve Attachment）</strong> 负责从 <strong>多采样转换为单采样</strong>：</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp复制编辑VkAttachmentDescription resolveAttachment = {};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolveAttachment.samples = VK_SAMPLE_COUNT_1_BIT; // 解析到单采样</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>在渲染通道（Render Pass）中指定解析目标</strong>：</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cpp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">复制编辑</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">subpass.pResolveAttachments = &amp;resolveAttachmentRef;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制��代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>💡 <strong>MSAA 颜色缓冲不会直接渲染到屏幕上，需要解析到单采样缓冲！</strong></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-msaa-的优缺点"><strong>5. MSAA 的优缺点</strong><a href="https://www.iogl.cn/blog/16.msaa#5-msaa-%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9" class="hash-link" aria-label="5-msaa-的优缺点的直接链接" title="5-msaa-的优缺点的直接链接">​</a></h2>
<table><thead><tr><th><strong>优点</strong></th><th><strong>缺点</strong></th></tr></thead><tbody><tr><td>✅ 提高边缘平滑度，减少锯齿</td><td>❌ 性能消耗较高</td></tr><tr><td>✅ 硬件级优化，支持广泛</td><td>❌ 不能减少纹理采样导致的锯齿</td></tr><tr><td>✅ 兼容大多数 GPU 和 API</td><td>❌ 仅对几何边缘生效，对透明纹理无效</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-msaa-vs-其他抗锯齿技术"><strong>6. MSAA vs 其他抗锯齿技术</strong><a href="https://www.iogl.cn/blog/16.msaa#6-msaa-vs-%E5%85%B6%E4%BB%96%E6%8A%97%E9%94%AF%E9%BD%BF%E6%8A%80%E6%9C%AF" class="hash-link" aria-label="6-msaa-vs-其他抗锯齿技术的直接链接" title="6-msaa-vs-其他抗锯齿技术的直接链接">​</a></h2>
<table><thead><tr><th><strong>抗锯齿技术</strong></th><th><strong>方式</strong></th><th><strong>优缺点</strong></th></tr></thead><tbody><tr><td><strong>MSAA（多重采样）</strong></td><td>仅对几何边缘采样，平均颜色</td><td>✅ 画质好，硬件支持；❌ 对透明纹理无效</td></tr><tr><td><strong>SSAA（超采样，SuperSampling）</strong></td><td>整个场景放大渲染再缩小</td><td>✅ 画质最好；❌ 计算量巨大</td></tr><tr><td><strong>FXAA（快速近似抗锯齿）</strong></td><td>纹理后处理</td><td>✅ 计算快，适合低端 GPU；❌ 模糊</td></tr><tr><td><strong>TAA（时间抗锯齿）</strong></td><td>结合前一帧信息进行平滑</td><td>✅ 对动态画面更有效；❌ 可能导致拖影</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-总结"><strong>7. 总结</strong><a href="https://www.iogl.cn/blog/16.msaa#7-%E6%80%BB%E7%BB%93" class="hash-link" aria-label="7-总结的直接链接" title="7-总结的直接链接">​</a></h2>
<ul>
<li><strong>MSAA 是一种 GPU 硬件支持的抗锯齿技术，专注于几何边缘的平滑处理。</strong></li>
<li><strong>它通过在像素内使用多个子采样点来减少锯齿效应，并且对性能的影响比 SSAA 小，但仍然比 FXAA 和 TAA 要高。</strong></li>
<li><strong>Vulkan 允许通过 <code>VkSampleCountFlagBits</code> 轻松启用 MSAA，并通过 <code>resolve attachment</code> 解析到最终帧缓冲。</strong></li>
<li><strong>在游戏或图形应用中，4x MSAA 通常是一个性能和画质的折中方案。</strong></li>
</ul>
<p>🚀 <strong>在 Vulkan 开发中，如果你需要抗锯齿但又想兼顾性能，4x MSAA 是一个不错的选择！</strong></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="图形基础" term="图形基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[MipMap与LOD是何物？]]></title>
        <id>https://www.iogl.cn/blog/11.MipMap与LOD是何物</id>
        <link href="https://www.iogl.cn/blog/11.MipMap与LOD是何物"/>
        <updated>2024-10-07T14:52:25.000Z</updated>
        <summary type="html"><![CDATA[MipMap与LOD是何物？]]></summary>
        <content type="html"><![CDATA[<p>MipMap与LOD是何物？</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lod模型金字塔">LOD:模型金字塔<a href="https://www.iogl.cn/blog/11.MipMap%E4%B8%8ELOD%E6%98%AF%E4%BD%95%E7%89%A9#lod%E6%A8%A1%E5%9E%8B%E9%87%91%E5%AD%97%E5%A1%94" class="hash-link" aria-label="LOD:模型金字塔的直接链接" title="LOD:模型金字塔的直接链接">​</a></h2>
<p>LOD：全称Level Of Detail，中文翻译“细节级别渐变”，顾名思义，不同的级别展示不同的细节，那么究竟这个技术是如何运用在游戏项目中的呢？通过例子我们来学习一下。关于为什么要使用这个技术，和游戏优化是密不可分的，使用这个技术可以减少需要处理的模型顶点数目，降低GPU性能瓶颈的风险。</p>
<p>原理：当模型离摄像机（可以是人物摄像机或其他摄像机）很远时，然后根据距离的远近使用不同模型级别，远的时候就选择低级别的模型，近的时候选择高细节模型，这样就可以减少模型上面的顶点和面片数量从而提高性能。</p>
<p>准备：准备三个相同的模型，但是这三个模型他们的三角面和顶点数都不同，这样就可以代表三种从高—中—低的层级。（由于没有找到模型资源，所以这里我们使用最能体现GPU性能消耗的particle特效来做，rate分别是20,10,5）</p>
<p>首先在层次面板创建一个EmptyGo，命名为TestLOD,对你找来的三个模型以“...LOD01”（结尾序号表示层级）命名，最后全部拖放到TestLOD下,记住记住，这三个物体位置要全部相同。</p>
<p><img decoding="async" loading="lazy" alt="img" src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAV0AAABQCAYAAAC6YabdAAAImElEQVR4nO3deYjMfxzH8feyWGFdYTfWfcQ6c+SIWEekHLkjipWQ3Edy32frPiJ/CCtHEnK3rBBR7qwoVohQjpzJr/dHM333mt2dnf3MfOf3fNTuzPea73f2j/d89vP5fl4TkZqa+lcAAIWudOnSUiTYFwEA/ycUXQCwiKILABZRdAHAosjfv3/Lz58/5c+fPznuVLRoUSlRooQUK1bM4qUBQPiJ1EJ669Yt+fDhQ447VaxYUdq1a+dd7tSpU477pqam+nUh+prOYzMvO504cUIOHDggb9++ldjYWElMTJQuXbpkuT79sChbtqy0bt1aRowYITVq1PDr2gAgUCL1V3x8vNy8eVN+/PiRZYeoqCiz3SmvxbEwXLt2Tfbt2ydz586V+vXrS1pamqxYscJcp/ODQa/p169f8u7dO7l06ZJMmjRJkpKSpE6dOtauFQAyM3260dHREhMTk+0Oul6358enT59k3rx50rNnTxk5cqQ8fPjQu+3ixYsyaNAg6dWrlyxevNis87RM9dFXK1rt379fpkyZIs2aNZOSJUtK8+bNZfLkybJ3794s+xYvXlyqVatmWrnjxo2TnTt35ut9AECgeQfStNWo/bZOuqzr82vTpk2meGo3gBbI9evXe7fpc22ZHj58WOrWrWvWeVrK+phbq/n58+fSpEmTDOuaNm0qT58+9Xlc586d5f79+/l+LwAQSJGeJ9oqrFevnjx48MC7UZd1fX7duHFDzp8/L8uWLTPL2rfqERcXJ7t27ZKEhATp169fQa49XyIiIqydCwByEulcqF69urx48UK+fPkiZcqUMcv++Pv3rxw/flzKly+fZdvGjRvlypUr5ufo0aOmAOeHXtO9e/ekffv23nW6XLt2bZ/HaQtauyIAIJgy3KdbpEgRadSokWkV6qMu+6NVq1amoGrxfv/+vaxZs8a7LTk52RTMMWPGyOvXr73rK1euLI8fP871tbV/Vgv33bt3zcDfnTt3zLL2E2emt8PpOfROh+3bt5t+XQAIpsjMK8qVK2cKoD76a+rUqaYQDhs2zLzOkCFDvNtevnxpCqTebaD7eehg2IwZM8zzkydPmsfMg2raWu3QoYN8/PhRVq1aZW4Zq1KliowaNUq6deuWYV89Vj80PLeMaT8zt4wBCLYIUsYAwA5SxgDAMoouAFhE0QUAiyi6AGARRRcALKLoAoBFYVV0cwvLyes+AFBYrBddT5JYjx49zISI9PT0Ar2Wk62ISV+FW0N+dFKIZksMHz5cUlJSshyrP5r/q9kTy5cvN1OvnT5//izTp083SWw6YUSXPXSWnQb36N8PgPsEpaWrxVGzGdq2beuNdwwHnqzfOXPmyKlTp2TmzJlm+vH169cz7Kfv/+zZs7JlyxYzS06zfp89e+bdvm3bNpP7e+jQIalZs6bs2LHDu61r164yceLEbLOPAYS+oHUvaBautvR0WrDT4MGDTWEZMGCASSrz0NahfqXQ6tWrzfbsMnidLdBv377JunXrpG/fvjJ69Gi5fft2lmvwlfvrj0Bl/eo3eej719ChgQMHmmWPvMRfAghdQSu6379/N63CzMlf2rq7cOGCydzVlqCTth61QGkQem4ZvHqsFrWDBw/KypUr5dixY1n28ZX7649AZf3qVydVqFDBPNevStLQIADhIUvgjQ1a6DQgXYNoZs+e7V3/6tUr2b17tzx69MiE2ugXZjr16dMnz+fQ6MgjR46Y82ir05Pt6+Qr99em7LJ+/U14AxDaglJ0c/r3WAeP+vfvL+PHjzdZvNqNUBC5FS5fub/+CFTWr7Zy9UOnUqVK5tHT6gXgfiHVnPr69au0aNFCSpUqZVqqufGVwdumTRs5c+aMaS1rBKR2V2TmK/fXH4HK+m3ZsqW5Lv17aLeILgMID0Fp6eZER/GnTZtmnvfu3TvX/bPL4HVu27Bhgxmg0gGpoUOHZjneV+5vbgoz63fChAmyZMkSM4imYfILFizI9rye5wysAe5Bni4AWKJ5uiHV0g0VviY/0KoEUBAU3WxQWAEUlpAaSAOAcEfRBQCLKLoAYBFFFwAsCquiS54ugFBn/e4FT9GLioqShg0bmqm/On3W39dy3mlgM083p3NpeI7OMtPJEbGxsZKYmGiyc53HKs158EyO0JlszskRmp+rkZeaQREfH28mR0RHR5ttp0+fNhNB0tLSTKDP2LFjzaQMAO5Anm4A2cjTvXr1qpmFd+7cOROArglqANyDPF2X5elqIlqtWrXMNOI3b95IXFxcga4ZgF3k6bo0T1f/fhqKM3/+/AJdMwC7yNN1YZ6utviTkpJMOJDGPwJwD/J0XZanqwV36dKlpkuEggu4T0jdMkae7j++8nQXLVpkBtd0EBKA+4RU4A15uv/4ytO9fPmy+dmzZ0+GcwNwB/J0AcAS8nRzQJ4ugMJC0c0GhRVAYQmpgTQACHcUXQCwiKILABZRdAHAorAquuTpAgh15OkG4LxOhZ2nq4llGgikORVVq1Y1M9nI0wXcgzzdALKRp6tpZDoVWI/XmWs6+w2Ae5Cn67I83bVr13oDdPQ9Nm7cuEDXDMCuoE2O8JWnq+lfT548kVmzZkn37t292zx5up44SF//5msrUrstNE9X/13fvHlzhuAY5cnTXbhwoWlBap6uM9MgvwqSp+vMDs5Lnm5CQoLExMTI1q1b/b5eAPaRp+vCPF2VkpJiwtz12jW0B4A7kKfrsjxdD/2A6NixY4G/7QKAXSF1yxh5uv/4ytPVQbr09HTTPZOcnGyiHwG4R0gF3pCn+4+vPN0GDRqYLhnt99UBO2f3DIDQR54uAFhCnm4OyNMFUFgoutmgsAIoLCE1kAYA4Y6iCwAWUXQBwCKKLgBYRNEFAIsougBgEUUXACyi6AKARRRdALCIogsAFlF0AcAiii4AWETRBQCLKLoAYBFFFwAs+g9RFZZGK99/JAAAAABJRU5ErkJggg==" width="349" height="80" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="img" src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAVoAAABOCAYAAABhYd5PAAAROklEQVR4nO2dCXBT5RbHT5u2aWkrS9mXgiirD4UHouBDRoqCA7IMIiDIDKugorg8HFnkgaDIooA6joNPGVlUFpmqg4jwGARkGSjwWIu0tKVYWbqlbZKuefl/9eYlJffetEma8uX8ZjL39ubm5uOQe+75zvd9/xOSnZ1tKysrI4ZhGMY/hK1cuZJSU1MD3Q6GYRhpCUlKSrIVFhYGuh0MwzDSEhroBjAMw8hOmL8uXFpaSjabjcLDwykkJMRfX8MwDOMxc+bMJ0PTLnQtPYtiYqPJYAijMEMEhdo9YXhYKEVGRNi3YWQMN1CHFg1p+Ij+Pvlevzja4uJiMrVZJ/ZjM6ZSZGSkP76GYRjGY+YuWEWGxl2oX98+9M+NY6lRrFHz/FFT5utes6KigjZu3Cj2J0yYQKGh7pMEfnO01wqPiv27i59jR8swTMA5knSM/nMwidZt2E6L1m4ljE01aRJHbVs2prZtmlPrVk2ofoyRWjSMpjB7JzzfUuL2OuipZ2Rk0P79+2ncuHF04MABcRz7cLr9+/en+Ph4l568i6NFdx9Osry8XLWxBoOBjEajSAmoAS9vKb/l2A9WUlJS6P333xdb2G337t2BbhLDBC3lJSUUFhlBVouF/jF0MCWnZorjWbkWSs26SKb8w1RUVEBNGsTQ/BkjVH0XHO2+ffvo0KFDDicLXnjhBbHF5yZOnKjuaOE8jx8/TtnZ2aqNjYuLoz59+tT8X+sHHn30Uc33f/3111pqiSsffPABXbx4kdasWUM9evQISBsYhqnEEG4kU4GFSstK4Q3tkWwcDep9t3hv5+HLlHWzkMrJRslnz4hjWiNLTz/9tHC04NlnnxXbzZs3O96rym2pg/vuu4+OHTtGVqv1tpORAsD7dQ1nR6o43UA5V2cuXboktt26dQtwSxiGCbH3KnPyi4RvyzdbKOHv8bRl7wURoY5O6EL/TjxJIaGhosduNpsRut52DUSrX331lcPJIi/7wAMPiH3kZ5E6ePXVV+mRRx4RUa2Ss73N0d51113UvHlzSktLu+1LcBzv34koDvi1116j7777jq5evSrCfzBq1CjKz88X+61bt6YZM2bQww8/7PK5SZMm0Q8//CDSKrNnz6bHHntMHL9w4QJ98sknDqfaqFEj+uabb1yi7AEDBogtnL/JZKK1a9fS0aOVOWz0DmbNmkWxsbGa7XTXDnwuOTmZ9uzZI34Azu1iGMaVsNBwyi8ootISC1mLS2nDrjOie9+xTSMyW8vIZneKNluFcLzCH7gZ18J95pxSQBYgOjrasV/1PFVHCzp27EhZWVkiX6sAL4/jeuDiJaWlVJhXjyKsZnEN5y8MNOjOV2X79u3CuOjmP//887R8+XLh5JxJSEig3r1708yZM+njjz92OLQFCxbQjRs36Msvv6R77rnHcT6cqrvoGk4Wudp33nlH2GXhwoXi+Ny5c3XbqbQDznn69Om0ePFi8QR9/PHHaerUqS7tYhjGlciYWDJbSshqj1ZLy8vsEW4oRUcY6NHu8fR7RjaVlZZRRTl8VTjl5eWRTSV5MHr0aBoyZAjNnz9f3PfKYD/2wZIlS6hevXoun3HraCMiIqhDhw509uxZxzH8jeNqwFEhysooLKcL9XvQ73/+i8avmU2d8+ZR5rRpFN6rlxgQCvSc2q1bt1KTJk0cjv/69eu0bt064WRv3aocwFO2zmAUUXmS3bx503FcuQ6M3rNnT5Gfadeuner3HzlyRGwfeughx7HDhw/rttNdO5S/bX91cZzbxTCMK6Fh4VRoKaZiq5Ws9gi21B7V3iww0+HTafTbf9PEfYRby2ouotzcXPfXsN+PcKxbtmxxHPv0009dzvnxxx9FkIWAzfE5tUbhBla6s9jibzVw498ssNI+a2PaVPE3WnH8Fh0614zMWS2pKCWFOtqjtfr2CM6ckRHwWQjNmjVzcV7IpyDCxNQMZ+O5w11UvmzZMnriiScIwjzff/89zZkzx6N24Fp48HjaTq12BPrhxTB3AliYcDU9ze5ICyknJ4dybtyiipJC6tW1FdlKLJSdfZMKCvLt93Jx5YSA21O0jvsWOdgHH3xQ9CoVsI9jffv2FSlIJZjCVnUeLS7YtWtXMTCGrbubHk7TXFxCvxVGU1JEJ9p1/gZFmU7TqMgsGt4tkgzLltK5xERqsXMntdi/nzofPUoZw4aR5bnnyBgdXSfSCciZgu7du4t0SXVp3769iGYxhQv5U70HCbr9P//8s4hilXPr2iwOhpGRCKORMtPTyWoxi3mwZdZS+9EKWrg6i7JzTIhYhE8qLSqi/Hzt4AW9VjhT9OLhXAHSBZiBEBZW6VaR0sNYDLaaCxYaNGhATZs2FVs11iebaZvJ7jTLLlAfWyZNaG+gds2aU1RUlHjfMnkyZQ8YQDc2bqTW9i812qNGi93BGP+acxZoXnnlFZHbHD9+vEt33lMQCStd9i5duogBKi3wProoK1asEH8PGjRI9zMMw/iAkBgqyi2kYmsZ5efm231sORnCDGSxWhyn2GwhVJSfQ2az+qox9CCRRsULjhY+ACCl4NxLbdy4sfAp2Hql3oWILP16Nq05Z6GRLcqoe+s4MQKHp4ISrSqjb0X2p0T2qVNk2LGD6tmdW1zbtnUiomUYJji4eiWDDv2WRAfOZFKx3SeFG+rZo1AjGcKj7FFouL2XHWvfD6NbWWnUtVkZxce3pMGDB2te03kWgrPfA1gAhpQiIlyvHS08eklJiZjaoDVYBnAevhznwfOzo2UYJhAU5JvIlGeiPPvrxJnLlPZnHpkKrFRgj3bzbqTSpDEDRXqgc+fONf4O5zSi13q06AbjhXBab1CmOucyDMPIgteiMtVxmuxgGYYJRvymR8sED1988UWgm1ArTJ48ucafDQYbsX3UYUfLeA2mp2Heb0xMTKCb4heQWsPCFm+Q2UZsH33Y0TI+AVNYlDXfsoFpO946EiCrjdg++tQ5R4ula2rKW1rvMYFHmajNqMM20kZW+3g9vwrODy8sQ8Xkf6y48AZ3kofu3mP8y65du2jKlCkuIvDYRx4OK9u0gCAHxHnQHYQSmqKMJhvvvvuuECRyZtu2bULsXY9gsZHiH6q+9JDNPj6ZyAoHmJiYKKQFFy1a5ItLMgEGE7Uxh3DTpk2OY99++63QI8ZqNi1WrVollN7gkKFo9uGHH/q7uQEBUpb4N6anp4u/IS0KSUvoZ+gRLDaCb3B+wTYjR47U/Zxs9vHZigEsuR0xYoTQT1XA0lQYFjcmts6qWHv37hVyY08++aSLc1aeds7bqsf0ro3z1q9fL3Rmhw8f7tCdZaoHeijQZIADgQ4E9l9++WXdz0GhDGu+oV2Mpc3u1MlkALnJefPmieXUEJNevXq1kM3UW7gDgsVGzqB6C/7d+F3pIZt9fOZoLRaL0EaFOIsCfnhQH9+xY4eoMoCSLgp4YqHrBTnAe++997brKWkC5UlYFa1rg/r16wtnCzUtaBkw1QcOA47jo48+ElKScCpateIU8BDEwAaA1CP0emWlbdu29NRTTwlBobFjxwpxfE8IJhsBBGCYwvX22297tCJUNvv4xNEighw2bBhduXKF3nzzTcfxkydPiqgVqjZjxoyhpKQkx3tt2rQRN+/BgwdFJFxdtK4N0D2BvCPSGazT6h2IKvAgxRJqTwmm5dXoVV27ds1RlcNTgsVGBQUF9N577wmVu+rMKpDJPj4Z4qvJIBUiUFSQxAsDCnC6/kBL85XRBroU6HXgBsFAGPQ2USEC1Ta0QCQCPU8ovyGlo0QmzP8JFhvhd4NqIhjQatmypcefk80+fn1kII0AMW1EQxhIca4E+/XXXwuBXIxs//HHH24/DyOj8kF1r834BqRnIHCM7nCrVq1EmRxPBiUQ2WEQDZEM6qfVRH5SdoLFRngwo2be/fffX63PyWYfvzpaJL1PnTolBqROnz7tkgRHzgZdfwxkqY3S4vw33niDhg4dWq1rM96D0V4UnnzmmWccx7Cfmpoqpn5p8frrr9P58+eF4DGugb8ZV4LFRhhDQa+outO7ZLOP1+pdDIMbAdO+MAApI5jDee7cOSHsXlNkthHbRx95ss0MwzB1FDnXuzEBIS4uTijKywSWhPpyVZJsNmL76AMbsaNlfAJyt3gx6rCNtJHZPpyjZRiG8TOco2UYhvEznDpgvEZ2dXwFriCgDdtHHXa0jNfIro7PFQS0Yfvow46W8Qkyq+NzBQFt2D763LGOlqst1D1kVcf3JWwjbWS1j88qLAwcOJCmTZumqk2g9tmanstO1r9whQV9uMKCPlxhoRKfVVj46aefhC4nV1iQA66woA9XWNCHKyxU4rPpXRCERt0wSJs5o1YJwV0FBQDhkoSEBFEd4ZdfflE9l6st+B+usKANV1ioHlxhwQfghwbpQ4T6zqhVQlCroADpwz179ohumVIZgastBAausKAPV1jwDK6w4AOUKrgpKSn01ltvubynVwnBGajUI/WAH+xLL71Eubm5Hn0/V1vwL1xhQRuusKANV1jwYY4WkSKeWrghawo0J5EXRAS1c+dOXzTNBa62UD2UCgsYlMCDb+nSpVRcXKz7OUUdH8igju8PgsVG3lZYADLYx2ePDCioz507l1auXOmivqNVCaFqBQVMfMb7eOqhxI0zXG2h9uEKC/4jWGzEFRYq8Wls3qlTJ5o6dSpt2LDBcUyrEkLVCgqzZs0SI7no/icnJ7tcm6st1C5cYcG/BIuNuMJCJazexXiN7Or4XEFAG7aPPvJkmxmGYeoocq53YwKCrOr4XEFAHbaPPlxhgfEZMqvj+wq2kTYy24dztAzDMH6Gc7QMwzB+hlMHjNfIro6vwBUEtGH7qMOOlvEa2dXxuYKANmwffdjRMj5BZnV8riCgDdtHnzrpaLl6wp2JrOr4voRtpI2s9vF6MAxPsoULF4qlsRCLXrx4Me3evdsXbWMCiDcVFqDyBUW13r17+7uZAcWbCgvBYqOaVliQzT5ePz6gVwoHC61XqGNhKd3mzZuFbCJz54L/0zNnzghhj4kTJ4pjnlZY6NmzZ200MeBAlwNC6L169RK6tEqFBU+Ed4LFRlV7ptA+gJ30kM0+Xke0kEbs16+fyK0gVwPlLCjOK5jNZqHoBcEXREMnTpxwvOeumkJVsOoEOpa48XHDY001UzvUtMICHDResuNNhYVgsZEz1amwIJt9vI5op0+fLl5wsB06dBDdAkjqKUCnNj4+XkidmUwmoTWrPK0gbWiz2ejSpUsiIoZST1Ugs4ZrIj0Bw6OWkOxTQeoKSoUF2BxiH55WWAgmnCsswIF4WmEh2FAqLOChJJOgt6d47WhRvQCOENHO5cuXRfSJCglK9xK6sshbGY1GioqKoiVLlojjUKT//PPPhRRaTk6OqqD00aNHRbSrfI7Fu2ufmlRYCCbwW4coenUrLAQLNa2wIBM+GeKDEISiE4sywc6OFrh7gkFfEk565syZ1LBhQ5FCcAci3sTERHEOU7soFRZwg2AgDAOd6GHgockwnlDTCguy4XUM/+KLL4rcC3JURUVFYkTaWZcSo4YYwUbEihkKuHGBVjUFZzDQgJFdPBVR0mL58uXeNpnxkJpWWGAYhZpWWJANryNalJhAhVmUmUFxRORfEQEpIG+FG/azzz4TBRIR7QKlmgIYMmSI6vVRPhxVbceNG0cNGjQQ1RcY/6NUWFD+jwAGLxGZ4MGJwUk1UIm46r5MAxu+IFhshFkGSpUFZ/TmyctmH1bvYrxGdnV8riCgDdtHn+Ab/mMYhqll5FzvxgQEWdXxuYKAOmwffbjCAuMzZFbH9xVsI21ktg/naBmGYfwM52gZhmH8DDtahmEYP8OOlmEYxs+EYeJwZmZmoNvBMAwjLTwYxjAM42f+B24ZT9oIIrBQAAAAAElFTkSuQmCC" width="346" height="78" class="img_ev3q"></p>
<p>接下来选择TestLOD，添加LODGroup组件，添加完事的组件面板应该如图：</p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170109231316039-0bbde6e1169156ebaabcc333348ded14.jpg" width="354" height="165" class="img_ev3q"></p>
<p>常用参数详解：</p>
<ul>
<li>
<p>FadeMode：这个表示模型级别变化时候的过渡方式</p>
</li>
<li>
<p>LOD 0 ..：细节级别，百分比表示摄像机的可见范围（范围可调）</p>
</li>
</ul>
<p>接下来我们运行游戏，在场景视图中我们手动拖动主摄像机，打开profile（性能分析器），可以看到在不同距离的时候，GPU的性能参数有明显的不同：</p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170109234522027-9935e6cdd039f16ab4d51edd0742bd50.jpg" width="263" height="199" class="img_ev3q"></p>
<p>（后）</p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170109234641200-16e051bddfceb26a9920de2af1523f0e.jpg" width="219" height="179" class="img_ev3q"></p>
<p>（前）</p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170109234534027-98d08165d1ebf1e15bdd4e72bcb8b878.jpg" width="303" height="205" class="img_ev3q"></p>
<p>其中绿线就表示批处理数目，明显发现后面的批处理数目降低了一个，蓝线表示pass数目，pass数目也降低了一个，后面的顶点数也将低了0.1k。为什么要强调这个？因为我们优化就是从减少DrawCall开始的，减少DrawCall需要使用批处理技术开始的。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mipmap纹理贴图金字塔">MipMap：纹理贴图金字塔<a href="https://www.iogl.cn/blog/11.MipMap%E4%B8%8ELOD%E6%98%AF%E4%BD%95%E7%89%A9#mipmap%E7%BA%B9%E7%90%86%E8%B4%B4%E5%9B%BE%E9%87%91%E5%AD%97%E5%A1%94" class="hash-link" aria-label="MipMap：纹理贴图金字塔的直接链接" title="MipMap：纹理贴图金字塔的直接链接">​</a></h2>
<p>正如上面所说，mipmap针对的是纹理贴图，大白话就是，一个模型身上会有贴图，当我们对这个贴图使用了MipMap技术之后，那么在游戏运行中这个模型的贴图会根据摄像机距离模型的远近而调整不同的不同质量的贴图显示。</p>
<p>在这个游戏场景中，我们给一个模型贴了一个木纹贴图，当我们没有对这个贴图使用MipMap技术的时候，无论我们摄像机距离模型的位置在哪，这张贴图永远都是显示一样的，这样是完全没有必要的，我们使用这个技术就是为了让当摄像机比较远的时候，你用在精细的贴图我们玩家也看不见，而且还浪费资源，提高了性能瓶颈。</p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170110165715043-0adabf91406796ce5f0678e8d78b822f.jpg" width="349" height="616" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170110165724816-e52482277e84155b742267878fd46abd.jpg" width="291" height="158" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170110165733956-9cc86a462b2d0dff8581c0d6c34c4c01.jpg" width="184" height="118" class="img_ev3q"></p>
<p>上面就是我们没有对贴图使用MipMap技术，然后测试的结果，那当我们使用了MinMap技术之后，结果又会是什么样子的呢？</p>
<p>发现图片大小变大了，这是因为我们使用MipMap技术之后，会对这个贴图生成八张精度质量不同的贴图，所以内存占用变大了。</p>
<p>所以关于这个技术是否使用，根据你的项目而定，什么都是有利有弊的。</p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170110170305167-dc20a0bc9888545105ecec34f590b2b6.jpg" width="348" height="543" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170110170314843-76f1792bec9e12f6de69e39342ea4675.jpg" width="219" height="123" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/20170110170323108-5cf623f341451bd770b8c17b9a828e28.jpg" width="177" height="107" class="img_ev3q"></p>
<hr>
<p>原文链接：<a href="https://blog.csdn.net/penchaoo/article/details/54291529" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/penchaoo/article/details/54291529</a></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="图形基础" term="图形基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[创建depth/stencil attachment]]></title>
        <id>https://www.iogl.cn/blog/14.创建depthstencil attachment</id>
        <link href="https://www.iogl.cn/blog/14.创建depthstencil attachment"/>
        <updated>2024-08-01T15:47:56.000Z</updated>
        <summary type="html"><![CDATA[创建过程]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建过程">创建过程<a href="https://www.iogl.cn/blog/14.%E5%88%9B%E5%BB%BAdepthstencil%20attachment#%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8B" class="hash-link" aria-label="创建过程的直接链接" title="创建过程的直接链接">​</a></h2>
<ol>
<li>创建一个depth/stencil image</li>
<li>查找image memory requirements</li>
<li>分配、绑定image memory</li>
<li>设置image layout</li>
<li>创建depth/stencil imageview</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">示例代码<a href="https://www.iogl.cn/blog/14.%E5%88%9B%E5%BB%BAdepthstencil%20attachment#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="示例代码的直接链接" title="示例代码的直接链接">​</a></h2>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkFormat image_format </span><span class="token operator">=</span><span class="token plain"> VK_FORMAT_D16_UNORM</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">//支持depth\stencil的format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkImageCreateInfo image_info </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkFormatProperties props</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkGetPhysicalDeviceFormatProperties</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">physical_device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> image_format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">linearTilingFeatures </span><span class="token operator">&amp;</span><span class="token plain"> VK_FORMAT_FEATURE_DEPTH_STENCIL_ATTACHMENT_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tiling </span><span class="token operator">=</span><span class="token plain"> VK_IMAGE_TILING_LINEAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">optimalTilingFeatures </span><span class="token operator">&amp;</span><span class="token plain"> VK_FORMAT_FEATURE_DEPTH_STENCIL_ATTACHMENT_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tiling </span><span class="token operator">=</span><span class="token plain"> VK_IMAGE_TILING_OPTIMAL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_IMAGE_CREATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pNext </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imageType </span><span class="token operator">=</span><span class="token plain"> VK_IMAGE_TYPE_2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">format </span><span class="token operator">=</span><span class="token plain"> image_format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">extent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">width </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">extent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">height </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">extent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">depth </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mipLevels </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">arrayLayers </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">samples </span><span class="token operator">=</span><span class="token plain"> VK_SAMPLE_COUNT_1_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">initialLayout </span><span class="token operator">=</span><span class="token plain"> VK_IMAGE_LAYOUT_UNDEFINED</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">usage </span><span class="token operator">=</span><span class="token plain"> VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">queueFamilyIndexCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pQueueFamilyIndices </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sharingMode </span><span class="token operator">=</span><span class="token plain"> VK_SHARING_MODE_EXCLUSIVE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">flags </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkImage image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCreateImage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">image_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkMemoryRequirements mem_reqs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkGetImageMemoryRequirements</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">mem_reqs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkMemoryAllocateInfo mem_alloc </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mem_alloc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mem_alloc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pNext </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mem_alloc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">memoryTypeIndex </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mem_alloc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">allocationSize </span><span class="token operator">=</span><span class="token plain"> mem_reqs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkDeviceMemory mem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkAllocateMemory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">mem_alloc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">mem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkBindImageMemory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkImageView view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkImageViewCreateInfo view_info </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_IMAGE_VIEW_CREATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pNext </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">image </span><span class="token operator">=</span><span class="token plain"> image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">format </span><span class="token operator">=</span><span class="token plain"> image_format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">r </span><span class="token operator">=</span><span class="token plain"> VK_COMPONENT_SWIZZLE_R</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">g </span><span class="token operator">=</span><span class="token plain"> VK_COMPONENT_SWIZZLE_G</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">b </span><span class="token operator">=</span><span class="token plain"> VK_COMPONENT_SWIZZLE_B</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">a </span><span class="token operator">=</span><span class="token plain"> VK_COMPONENT_SWIZZLE_A</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subresourceRange</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">aspectMask </span><span class="token operator">=</span><span class="token plain"> VK_IMAGE_ASPECT_DEPTH_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">//或者是VK_IMAGE_ASPECT_STENCIL_BIT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subresourceRange</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">baseMipLevel </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subresourceRange</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">levelCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subresourceRange</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">baseArrayLayer </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subresourceRange</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layerCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">viewType </span><span class="token operator">=</span><span class="token plain"> VK_IMAGE_VIEW_TYPE_2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">flags </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCreateImageView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">view_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="图形基础" term="图形基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[创建mvp ubo]]></title>
        <id>https://www.iogl.cn/blog/15.创建mvp ubo</id>
        <link href="https://www.iogl.cn/blog/15.创建mvp ubo"/>
        <updated>2024-08-01T15:47:18.000Z</updated>
        <summary type="html"><![CDATA[创建过程]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建过程">创建过程<a href="https://www.iogl.cn/blog/15.%E5%88%9B%E5%BB%BAmvp%20ubo#%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8B" class="hash-link" aria-label="创建过程的直接链接" title="创建过程的直接链接">​</a></h2>
<ol>
<li>创建一个uniform buffer</li>
<li>查找buffer memory requirements</li>
<li>分配、绑定buffer memory</li>
<li>map buffer memory</li>
<li>拷贝mvp data to buffer memory</li>
<li>unmap buffer memory</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">示例代码<a href="https://www.iogl.cn/blog/15.%E5%88%9B%E5%BB%BAmvp%20ubo#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="示例代码的直接链接" title="示例代码的直接链接">​</a></h2>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 projection </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">perspective</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">radians</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">45.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 view </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">lookAt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// 相机在世界坐标系中的位置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">     </span><span class="token comment" style="color:rgb(98, 114, 164)">// 看向的目标位置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">     </span><span class="token comment" style="color:rgb(98, 114, 164)">// 相机up方向向量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">				 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 model </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">mat4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 clip </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">mat4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token operator">-</span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">					  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 mvp </span><span class="token operator">=</span><span class="token plain"> clip </span><span class="token operator">*</span><span class="token plain"> projection </span><span class="token operator">*</span><span class="token plain"> view </span><span class="token operator">*</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkBuffer ubo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkBufferCreateInfo buf_info </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buf_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_BUFFER_CREATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buf_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pNext </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buf_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">usage </span><span class="token operator">=</span><span class="token plain"> VK_BUFFER_USAGE_UNIFORM_BUFFER_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buf_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">size </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">mvp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buf_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">queueFamilyIndexCount </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buf_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pQueueFamilyIndices </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buf_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sharingMode </span><span class="token operator">=</span><span class="token plain"> VK_SHARING_MODE_EXCLUSIVE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">buf_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">flags </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCreateBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">buf_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">ubo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkMemoryRequirements mem_reqs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkGetBufferMemoryRequirements</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ubo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">mem_reqs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkDeviceMemory mem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkMemoryAllocateInfo alloc_info </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">alloc_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sType </span><span class="token operator">=</span><span class="token plain"> VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">alloc_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pNext </span><span class="token operator">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">alloc_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">memoryTypeIndex </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">alloc_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">allocationSize </span><span class="token operator">=</span><span class="token plain"> mem_reqs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkAllocateMemory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">alloc_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">mem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkBindBufferMemory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ubo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint8_t</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain">pData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkMapMemory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mem_reqs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">&amp;</span><span class="token plain">pData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">memcpy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">pData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">mvp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">mvp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkUnmapMemory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">device</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="图形基础" term="图形基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Vulkan vertex buffer绑定过程]]></title>
        <id>https://www.iogl.cn/blog/13.Vulkan vertex buffer绑定过程</id>
        <link href="https://www.iogl.cn/blog/13.Vulkan vertex buffer绑定过程"/>
        <updated>2023-12-28T15:11:34.000Z</updated>
        <summary type="html"><![CDATA[代码实战]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="代码实战">代码实战<a href="https://www.iogl.cn/blog/13.Vulkan%20vertex%20buffer%E7%BB%91%E5%AE%9A%E8%BF%87%E7%A8%8B#%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98" class="hash-link" aria-label="代码实战的直接链接" title="代码实战的直接链接">​</a></h2>
<p>我们用<code>indirect draw</code>绘制6个不同位置的三角形，效果如下：</p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/65d40e76ed5251bbdf967ad36292d56b-b74900fe6acee48dcf61f12627dcb7c3.png" width="905" height="659" class="img_ev3q"></p>
<p><strong>重点：具备<code>layout(location = xx) in</code> 格式描述的资源就是 <code>vertex buffer</code>。</strong></p>
<p>vs shader如下， <code>inPos</code>，<code>inColor</code>，<code>instancePos</code>则是<code>vertext buffer</code>数据：</p>
<div class="language-glsl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-glsl codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//vs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#version 450 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout (location = 0) in vec3 inPos;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout (location = 1) in vec3 inColor;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout (location = 2) in vec3 instancePos;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout(location = 0) out vec3 fragColor;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void main() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    gl_Position = vec4(inPos, 1.0) + vec4(instancePos, 1.0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    gl_Position.y = -gl_Position.y;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fragColor = inColor;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>vertex buffer</code>的布局分布如下：</p>
<ul>
<li><code>location 0</code>的<code>inPos</code>、<code>location 1</code>的<code>inColor</code>使用<code>binding 0</code></li>
<li><code>location 2</code>的<code>instancePos</code>使用<code>binding 1</code></li>
</ul>
<p>代码侧调用<code>vkCmdBindVertexBuffers</code>告诉gpu从哪个binding位置读取顶点数据（即<code>vkCmdBindVertexBuffers</code>的<code>firstBinding</code>参数，与shader中<code>layout</code>的<code>binding</code>完全没关系，这点在后面的<code>descriptor</code>章节再讲）。</p>
<p>gpu知道了从哪里读数据，但是怎么读？这就用到了<code>VkVertexInputBindingDescription</code>和 <code>VkVertexInputAttributeDescription</code>两个结构体，它们在创建<code>pipeline</code>时被使用。</p>
<p>结构体详细说明：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token class-name">VkVertexInputBindingDescription</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token plain">             binding</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">//数据绑定位置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token plain">             stride</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">//连续两个数据之间的间隔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkVertexInputRate    inputRate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">//两种方式， per-vertex:对每个顶点输入， per-instance:对每个实例输入</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> VkVertexInputBindingDescription</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token class-name">VkVertexInputAttributeDescription</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token plain">    location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">//在shader中location一致</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token plain">    binding</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">     </span><span class="token comment" style="color:rgb(98, 114, 164)">//数据绑定位置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VkFormat    format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">//数据格式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">uint32_t</span><span class="token plain">    offset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">//属性相对于顶点开始位置的偏移</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> VkVertexInputAttributeDescription</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里需要注意的是<code>VkVertexInputBindingDescription::inputRate</code>， 它代表两种数据输入：</p>
<ul>
<li>VK_VERTEX_INPUT_RATE_VERTEX：per-vertex，按图元的定点数分</li>
<li>VK_VERTEX_INPUT_RATE_INSTANCE：per-instance，按图元数分配</li>
</ul>
<p>本例画6个三角形，对于编号<code>i</code>的三角形，会读取顶点数据<code>vertices[0]</code>,<code>vertices[1]</code>,<code>vertices[2]</code>以及中心点位置<code>instancePosData[i]</code>。</p>
<p>本例完整代码说明：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">/* {inPosition, inColor}*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token class-name">Vertex</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vec3 pos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vec3 color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// vertex data of triangle</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">vector</span><span class="token operator">&lt;</span><span class="token plain">Vertex</span><span class="token operator">&gt;</span><span class="token plain"> vertices </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.2f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.2f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.2f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token number">0.2f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token operator">-</span><span class="token number">0.2f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 6 triangle instance center point postion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">vector</span><span class="token operator">&lt;</span><span class="token plain">Vec3</span><span class="token operator">&gt;</span><span class="token plain"> instancePosData </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">-</span><span class="token number">0.45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token operator">-</span><span class="token number">0.45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token number">0.45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token number">0.45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//create vertex buffer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkDeviceSize vertexBufferSize </span><span class="token operator">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Vertex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkDeviceSize instancePosBufferSize </span><span class="token operator">=</span><span class="token plain"> instancePosData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">createBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        VK_BUFFER_USAGE_VERTEX_BUFFER_BIT </span><span class="token operator">|</span><span class="token plain"> VK_BUFFER_USAGE_TRANSFER_DST_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT </span><span class="token operator">|</span><span class="token plain"> VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token operator">&amp;</span><span class="token plain">vertexBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">vertexMemory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        vertexBufferSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">createBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VK_BUFFER_USAGE_VERTEX_BUFFER_BIT </span><span class="token operator">|</span><span class="token plain"> VK_BUFFER_USAGE_TRANSFER_DST_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT </span><span class="token operator">|</span><span class="token plain"> VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&amp;</span><span class="token plain">instancePosBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">instancePosMemory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    instancePosBufferSize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">instancePosData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VkDeviceSize offsets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//三角形顶点位置、颜色数据从binding 0读取</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdBindVertexBuffers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    commandBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// firstBinding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// bindingCount</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&amp;</span><span class="token plain">vertexBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    offsets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//三角形的中心点位置从binding 1读取</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vkCmdBindVertexBuffers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    commandBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// firstBinding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// bindingCount</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&amp;</span><span class="token plain">instancePosBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    offsets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// 读取顶点的方式、以及顶点数据布局传入graphicsPipelineCreateInfo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">vector</span><span class="token operator">&lt;</span><span class="token plain">VkVertexInputBindingDescription</span><span class="token operator">&gt;</span><span class="token plain"> bindingDescription </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">binding</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">stride</span><span class="token operator">=</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Vertex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">inputRate </span><span class="token operator">=</span><span class="token plain"> VK_VERTEX_INPUT_RATE_VERTEX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">//逐顶点方式获取三角形顶点数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">binding</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">stride</span><span class="token operator">=</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">inputRate </span><span class="token operator">=</span><span class="token plain"> VK_VERTEX_INPUT_RATE_INSTANCE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">//逐实例方式获取三角形位置数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">vector</span><span class="token operator">&lt;</span><span class="token plain">VkVertexInputAttributeDescription</span><span class="token operator">&gt;</span><span class="token plain"> attributeDescriptions </span><span class="token operator">=</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">binding </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">format </span><span class="token operator">=</span><span class="token plain"> VK_FORMAT_R32G32B32_SFLOAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">offset </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">offsetof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Vertex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> pos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">// inPos: binding 0, location 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">binding </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">format </span><span class="token operator">=</span><span class="token plain"> VK_FORMAT_R32G32B32_SFLOAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">offset </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">offsetof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Vertex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// inColor: binding 0, location 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">binding </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">format </span><span class="token operator">=</span><span class="token plain"> VK_FORMAT_R32G32B32_SFLOAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">offset </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// instancePos: binding 1, location 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkPipelineVertexInputStateCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pVertexBindingDescriptions </span><span class="token operator">=</span><span class="token plain"> bindingDescription</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkPipelineVertexInputStateCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pVertexAttributeDescriptions </span><span class="token operator">=</span><span class="token plain"> attributeDescriptions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vkGraphicsPipelineCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pVertexInputState </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">vkPipelineVertexInputStateCreateInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上面从代码到<code>shader</code>的<code>vertex buffer</code>数据绑定过程可以归纳成这张图：</p>
<p><img decoding="async" loading="lazy" alt="img" src="https://www.iogl.cn/assets/images/8713daef75640687c030b03e04e8abdf-216d6e8a28683654fc3641e858a293de.png" width="1673" height="763" class="img_ev3q"></p>
<p>这篇文章对vertext buffer的处理逻辑讲的很详细，可以扩展阅读一下：</p>
<p><a href="https://github.com/KhronosGroup/Vulkan-Guide/blob/main/chapters/vertex_input_data_processing.adoc" target="_blank" rel="noopener noreferrer">https://github.com/KhronosGroup/Vulkan-Guide/blob/main/chapters/vertex_input_data_processing.adoc</a></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="图形基础" term="图形基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[一种简单加载vulkan动态库的方法]]></title>
        <id>https://www.iogl.cn/blog/12.一种简单加载vulkan动态库的方法</id>
        <link href="https://www.iogl.cn/blog/12.一种简单加载vulkan动态库的方法"/>
        <updated>2023-12-28T14:59:58.000Z</updated>
        <summary type="html"><![CDATA[背景]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="背景">背景<a href="https://www.iogl.cn/blog/12.%E4%B8%80%E7%A7%8D%E7%AE%80%E5%8D%95%E5%8A%A0%E8%BD%BDvulkan%E5%8A%A8%E6%80%81%E5%BA%93%E7%9A%84%E6%96%B9%E6%B3%95#%E8%83%8C%E6%99%AF" class="hash-link" aria-label="背景的直接链接" title="背景的直接链接">​</a></h2>
<p>最近在国产linux环境上适配vulkan应用，一般系统会自带<code>libvulkan.so.1</code>但是没有<code>libvulkan.so</code>，而<code>libvulkan.so.1</code>无法通过find_library找到，如果系统源没有<code>vulkan sdk</code>或者<code>vulkan loader</code>，这时就得手工下载代码编译<code>vulkan sdk</code>或者<code>vulkan loader</code>，过程中可能还得安装各种依赖，升级cmake，非常繁琐，安装完成后使用下面的方式将vulkan动态库链接到目标应用：</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">find_package(Vulkan)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if (NOT Vulkan_FOUND)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    find_library(Vulkan_LIBRARIES NAMES vulkan REQUIRED)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">endif ()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">include_directories(${Vulkan_INCLUDE_DIRS})</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">target_link_libraries (${PROJECT_NAME} ${Vulkan_LIBRARIES})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在麒麟、龙芯、鲲鹏等各种系统上都经历过手工编译<code>vulkan sdk</code>，为了更快的测试vulkan兼容性以及调试应用，一直在找更简易的方法。</p>
<p>闲暇之余看到了这篇文章  <a href="https://link.zhihu.com/?target=https%3A//djang86.blogspot.com/2019/01/what-is-vknoprototypes.html" target="_blank" rel="noopener noreferrer">WHAT IS VK_NO_PROTOTYPES</a>，萌生了写一个简易的vulkan动态库加载方法的想法，不用安装<code>vulkan sdk</code>或者<code>vulkan loader</code>，直接使用系统上的<code>libvulkan.so.1</code>(一般都会自带，没有的话执行<code>sudo apt install libvulkan1</code>安装)。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="代码示例">代码示例<a href="https://www.iogl.cn/blog/12.%E4%B8%80%E7%A7%8D%E7%AE%80%E5%8D%95%E5%8A%A0%E8%BD%BDvulkan%E5%8A%A8%E6%80%81%E5%BA%93%E7%9A%84%E6%96%B9%E6%B3%95#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" class="hash-link" aria-label="代码示例的直接链接" title="代码示例的直接链接">​</a></h2>
<p>基本原理是初始化时使用 <code>dlopen</code>、<code>dlsym</code>加载vulkan动态库中的api函数指针，app直接使用这些api，这里我用了一个开源的动态库加载工具<code>dylib</code>，它支持多系统平台:</p>
<p><a href="https://github.com/martin-olivier/dylib" target="_blank" rel="noopener noreferrer">GitHub - martin-olivier/dylib: C++ cross-platform wrapper around dynamic loading of shared libraries (dll, so, dylib)</a></p>
<p>以<code>vkCreateInstance</code>函数地址的加载过程为例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">//加载vulkan动态库</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dylib </span><span class="token function" style="color:rgb(80, 250, 123)">lib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">"libvulkan.so.1"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//定义函数指针vkCreateInstance, PFN_vkCreateInstance的声明在vulkan_core.h中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PFN_vkCreateInstance vkCreateInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//从动态库中获取函数地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">auto</span><span class="token plain"> vkCreateInstance </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">PFN_vkCreateInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">lib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token generic-function function" style="color:rgb(80, 250, 123)">get_function</span><span class="token generic-function generic class-name operator">&lt;</span><span class="token generic-function generic class-name">PFN_vkCreateInstance</span><span class="token generic-function generic class-name operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">"vkCreateInstance"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里有个小tip：<code>vkCreateInstance</code> 在<code>vulkan_core.h</code>中的声明是被宏<code>VK_NO_PROTOTYPES</code>括起来的，我们得在cmake中添加该宏定义<code>add_definitions(-DVK_NO_PROTOTYPES)</code>，不让 <code>vulkan_core.h</code>中对原生的vk api进行声明，这样我们就可以在<code>load.h</code>中对原生的vulkan api进行声明了。</p>
<p>附上整个<code>load.h</code>的源码，在app初始化时调用<code>vk_loader_init()</code>即可加载vulkan动态库中所有的函数地址：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">"dylib/dylib.hpp"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">"vulkan/vulkan_core.h"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token macro property"> </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">defined</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">WIN32</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression"> </span><span class="token macro property expression operator">||</span><span class="token macro property expression"> </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">defined</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">_WIN32</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression"> </span><span class="token macro property expression operator">||</span><span class="token macro property expression"> </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">defined</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">_WIN32_</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression"> </span><span class="token macro property expression operator">||</span><span class="token macro property expression"> </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">defined</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">WIN64</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression"> </span><span class="token macro property expression operator">||</span><span class="token macro property expression"> </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">defined</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">_WIN64</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression"> </span><span class="token macro property expression operator">||</span><span class="token macro property expression"> </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">defined</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">_WIN64_</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name">VULKAN_LIB</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">"vulkan-1.dll"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">elif</span><span class="token macro property"> </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">defined</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">ANDROID</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression"> </span><span class="token macro property expression operator">||</span><span class="token macro property expression"> </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">defined</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">_ANDROID_</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name">VULKAN_LIB</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">"libvulkan.so"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name">VULKAN_LIB</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">"libvulkan.so.1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">endif</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name function" style="color:rgb(80, 250, 123)">APPLY_PFN_DEF_VK_FUNCTIONS</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetInstanceProcAddr</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateInstance</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkEnumerateInstanceExtensionProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkEnumerateInstanceLayerProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyInstance</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkEnumeratePhysicalDevices</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                            </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceFeatures</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                           </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceFormatProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceImageFormatProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">              </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceQueueFamilyProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">              </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceMemoryProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetDeviceProcAddr</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateDevice</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                        </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroySurfaceKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceSurfaceSupportKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceSurfaceCapabilitiesKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">             </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceSurfaceFormatsKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceSurfacePresentModesKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">             </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateSwapchainKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroySwapchainKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetSwapchainImagesKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                               </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkAcquireNextImageKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkQueuePresentKHR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyDevice</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkEnumerateDeviceExtensionProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkEnumerateDeviceLayerProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetDeviceQueue</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkQueueSubmit</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkQueueWaitIdle</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDeviceWaitIdle</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkAllocateMemory</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkFreeMemory</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                          </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkMapMemory</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                           </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkUnmapMemory</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkFlushMappedMemoryRanges</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                             </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkInvalidateMappedMemoryRanges</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                        </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetDeviceMemoryCommitment</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                           </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkBindBufferMemory</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkBindImageMemory</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetBufferMemoryRequirements</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetImageMemoryRequirements</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                          </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetImageSparseMemoryRequirements</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPhysicalDeviceSparseImageFormatProperties</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">        </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkQueueBindSparse</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateFence</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyFence</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                        </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkResetFences</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetFenceStatus</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkWaitForFences</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateSemaphore</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroySemaphore</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateEvent</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyEvent</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                        </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetEventStatus</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkSetEvent</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                            </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkResetEvent</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                          </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateQueryPool</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyQueryPool</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetQueryPoolResults</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                        </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateBufferView</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyBufferView</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateImage</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyImage</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                        </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetImageSubresourceLayout</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                           </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateImageView</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyImageView</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateShaderModule</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyShaderModule</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreatePipelineCache</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyPipelineCache</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetPipelineCacheData</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkMergePipelineCaches</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateGraphicsPipelines</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                             </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateComputePipelines</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                              </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyPipeline</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreatePipelineLayout</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyPipelineLayout</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                               </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateSampler</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroySampler</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateDescriptorSetLayout</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                           </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyDescriptorSetLayout</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                          </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateDescriptorPool</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyDescriptorPool</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                               </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkResetDescriptorPool</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkAllocateDescriptorSets</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                              </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkFreeDescriptorSets</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkUpdateDescriptorSets</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateFramebuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyFramebuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateRenderPass</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyRenderPass</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkGetRenderAreaGranularity</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                            </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCreateCommandPool</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkDestroyCommandPool</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkResetCommandPool</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkAllocateCommandBuffers</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                              </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkFreeCommandBuffers</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkBeginCommandBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkEndCommandBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkResetCommandBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdBindPipeline</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetViewport</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetScissor</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetLineWidth</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetDepthBias</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetBlendConstants</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetDepthBounds</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetStencilCompareMask</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                            </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetStencilWriteMask</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                              </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetStencilReference</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                              </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdBindDescriptorSets</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                               </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdBindIndexBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdBindVertexBuffers</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdDraw</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                             </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdDrawIndexed</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdDrawIndirect</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdDrawIndexedIndirect</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                              </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdDispatch</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdDispatchIndirect</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdCopyBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdCopyImage</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                        </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdBlitImage</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                        </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdCopyBufferToImage</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdCopyImageToBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdUpdateBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdFillBuffer</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdClearColorImage</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdClearDepthStencilImage</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                           </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdClearAttachments</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                 </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdResolveImage</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                     </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdSetEvent</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdResetEvent</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdWaitEvents</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdPipelineBarrier</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdBeginQuery</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                       </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdEndQuery</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdResetQueryPool</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdWriteTimestamp</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                   </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdCopyQueryPoolResults</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                             </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdPushConstants</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdBeginRenderPass</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                  </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdNextSubpass</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                      </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdEndRenderPass</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                                    </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression function" style="color:rgb(80, 250, 123)">PFN_DEF</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">vkCmdExecuteCommands</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name function" style="color:rgb(80, 250, 123)">DEFINE_VK_FUNCTION_MACRO</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">function</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression">PFN_</span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">##</span><span class="token macro property expression">function function</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">define</span><span class="token macro property"> </span><span class="token macro property macro-name function" style="color:rgb(80, 250, 123)">GET_VK_FUNCTION_PROCADDR</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">function</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression">                         </span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token macro property"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token macro property">    </span><span class="token macro property expression">function </span><span class="token macro property expression operator">=</span><span class="token macro property expression"> </span><span class="token macro property expression keyword" style="color:rgb(189, 147, 249);font-style:italic">reinterpret_cast</span><span class="token macro property expression operator">&lt;</span><span class="token macro property expression">PFN_</span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">##</span><span class="token macro property expression">function</span><span class="token macro property expression operator">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">lib</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token macro property expression">get_function</span><span class="token macro property expression operator">&lt;</span><span class="token macro property expression">PFN_</span><span class="token macro property punctuation" style="color:rgb(248, 248, 242)">##</span><span class="token macro property expression">function</span><span class="token macro property expression operator">&gt;</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token macro property expression">#function</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token macro property expression punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">APPLY_PFN_DEF_VK_FUNCTIONS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">DEFINE_VK_FUNCTION_MACRO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">vk_loader_init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> dylib </span><span class="token function" style="color:rgb(80, 250, 123)">lib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">VULKAN_LIB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">APPLY_PFN_DEF_VK_FUNCTIONS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GET_VK_FUNCTION_PROCADDR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="项目实战">项目实战<a href="https://www.iogl.cn/blog/12.%E4%B8%80%E7%A7%8D%E7%AE%80%E5%8D%95%E5%8A%A0%E8%BD%BDvulkan%E5%8A%A8%E6%80%81%E5%BA%93%E7%9A%84%E6%96%B9%E6%B3%95#%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98" class="hash-link" aria-label="项目实战的直接链接" title="项目实战的直接链接">​</a></h2>
<p>这是整个测试demo的项目地址：</p>
<p><a href="https://gitee.com/sumcai/MiniVulkanTriangle" target="_blank" rel="noopener noreferrer">sumcai/MiniVulkanTriangle (gitee.com)</a></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="图形基础" term="图形基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Framebuffer用法]]></title>
        <id>https://www.iogl.cn/blog/09.Framebuffer用法</id>
        <link href="https://www.iogl.cn/blog/09.Framebuffer用法"/>
        <updated>2021-12-26T20:14:37.000Z</updated>
        <summary type="html"><![CDATA[opengl中framebuffer称为帧缓冲，它是一个内存缓冲区，如果把渲染到屏幕的颜色缓冲，深度缓冲，模板缓冲都缓存到内存中，那么就叫帧缓冲。]]></summary>
        <content type="html"><![CDATA[<p>opengl中framebuffer称为帧缓冲，它是一个内存缓冲区，如果把渲染到屏幕的颜色缓冲，深度缓冲，模板缓冲都缓存到内存中，那么就叫帧缓冲。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="framebuffer用法">Framebuffer用法<a href="https://www.iogl.cn/blog/09.Framebuffer%E7%94%A8%E6%B3%95#framebuffer%E7%94%A8%E6%B3%95" class="hash-link" aria-label="Framebuffer用法的直接链接" title="Framebuffer用法的直接链接">​</a></h2>
<p>framebuffer通常用在离屏渲染或者后处理上，主要涉及这几个函数：</p>
<ul>
<li><code>glGenFramebuffers</code> ：创建framebuffer</li>
<li><code>glBindFramebuffer</code> ：绑定framebuffer</li>
<li><code>glFramebufferTexture2D</code> ：将纹理附加到framebuffer到，实现绘制到纹理</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">示例代码<a href="https://www.iogl.cn/blog/09.Framebuffer%E7%94%A8%E6%B3%95#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="示例代码的直接链接" title="示例代码的直接链接">​</a></h2>
<p>我们模拟一个后处理操作，将<a href="http://iogl.cn/opengl/blend/" target="_blank" rel="noopener noreferrer">Blend用法</a>中的绘制结果画在屏幕中央，并且对结果的颜色取反向，让我们看看具体代码：</p>
<p><code>05.FBTexture.fs</code>内容：</p>
<div class="language-glsl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-glsl codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#version 330 core</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">in vec2 TexCoord;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uniform sampler2D tex1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">out vec4 FragColor;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void main()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    FragColor = vec4(vec3(1.0 - texture(tex1, TexCoord)), 1.0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>实现代码：</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void display( GLFWwindow* window )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 1.绑定framebuffer，这样可以绘制到附加的纹理fbTexture上</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnable(GL_DEPTH_TEST);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnable(GL_BLEND);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glClearColor( 0, 0, 0.4, 0 );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glUseProgram(boxProgramID);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm::mat4 projection = glm::perspective(glm::radians(45.0f), (float) 5 / (float)5, 0.1f, 100.0f);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm::mat4 view = glm::lookAt(glm::vec3(1,2,3), glm::vec3(0,0,0), glm::vec3(0,1,0));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm::mat4 model = glm::mat4(1.0f);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm::mat4 mvp = projection * view * model;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 2.画地面</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint mvpId = glGetUniformLocation(boxProgramID, "MVP");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glUniformMatrix4fv(mvpId, 1, GL_FALSE, &amp;mvp[0][0]);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(FloorVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindTexture(GL_TEXTURE_2D, floorTexture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glDrawArrays(GL_TRIANGLES, 0, 6);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 3.画立方体</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(VAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindTexture(GL_TEXTURE_2D, texture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glDrawArrays(GL_TRIANGLES, 0, 36);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 4.画blend物体</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model = glm::mat4(1.0f);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model = glm::translate(model, glm::vec3(0, 0, 1.01f));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mvp = projection * view * model;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glUniformMatrix4fv(mvpId, 1, GL_FALSE, &amp;mvp[0][0]);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindTexture(GL_TEXTURE_2D, blendTexture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glDrawArrays(GL_TRIANGLES, 0, 6);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 5.对fbTexture采样后处理将绘制到屏幕</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glDisable(GL_DEPTH_TEST);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glDisable(GL_BLEND);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindFramebuffer(GL_FRAMEBUFFER, 0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glClearColor(0.3f, 0.3f, 0.3f, 1.0f);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glClear(GL_COLOR_BUFFER_BIT);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glUseProgram(screenProgramID);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(screenVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindTexture(GL_TEXTURE_2D, fbTexture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glDrawArrays(GL_TRIANGLES, 0, 6);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void prepare() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    boxProgramID = LoadShaders( "data/shader/03.MVP.vs", "data/shader/03.MVP.fs" );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const GLfloat g_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f, -0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f, -0.5f,  0.0f, 1.0f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float fllor_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            5.0f, -0.5f,  5.0f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -5.0f, -0.5f,  5.0f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -5.0f, -0.5f, -5.0f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            5.0f, -0.5f,  5.0f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -5.0f, -0.5f, -5.0f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            5.0f, -0.5f, -5.0f,  1.0f, 1.0f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float blend_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.0f,  0.5f,  0.0f,  0.0f,  0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.0f, -0.5f,  0.0f,  0.0f,  1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            1.0f, -0.5f,  0.0f,  1.0f,  1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.0f,  0.5f,  0.0f,  0.0f,  0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            1.0f, -0.5f,  0.0f,  1.0f,  1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            1.0f,  0.5f,  0.0f,  1.0f,  0.0f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 1.VAO、VBO的数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenVertexArrays(1, &amp;VAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(VAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint VBO1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenBuffers(1, &amp;VBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindBuffer(GL_ARRAY_BUFFER, VBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 纹理坐标</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)(3 * sizeof(GLfloat)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 2.地面贴图</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenVertexArrays(1, &amp;FloorVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(FloorVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint VBO2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenBuffers(1, &amp;VBO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindBuffer(GL_ARRAY_BUFFER, VBO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBufferData(GL_ARRAY_BUFFER, sizeof(fllor_vertex_buffer_data), fllor_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 纹理坐标</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)(3 * sizeof(GLfloat)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 3.blend贴图</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenVertexArrays(1, &amp;BlendVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(BlendVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint VBO3;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenBuffers(1, &amp;VBO3);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindBuffer(GL_ARRAY_BUFFER, VBO3);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBufferData(GL_ARRAY_BUFFER, sizeof(blend_vertex_buffer_data), blend_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 纹理坐标</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)(3 * sizeof(GLfloat)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 纹理数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    floorTexture = loadTexture("data/img/33.png");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    texture = loadTexture("data/img/11.jpg");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    blendTexture = loadTexture("data/img/chick.png");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 4.创建framebuffer以及附加的纹理</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenFramebuffers(1, &amp;framebuffer);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenTextures(1, &amp;fbTexture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindTexture(GL_TEXTURE_2D, fbTexture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, 512, 512, 0, GL_RGB, GL_UNSIGNED_BYTE, NULL);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, fbTexture, 0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 5.绘制到屏幕的shader和顶点数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    screenProgramID = LoadShaders( "data/shader/02.Texture.vs", "data/shader/05.FBTexture.fs" );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const GLfloat g_screen_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.0f,  0.0f,  1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f,  0.0f,  0.0f,  0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.0f,   1.0f,  0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.0f,  0.0f,  1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.0f,  1.0f,  0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.0f,  1.0f,  1.0f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // VAO、VBO的数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint screenVBO;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenVertexArrays(1, &amp;screenVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(screenVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenBuffers(1, &amp;screenVBO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindBuffer(GL_ARRAY_BUFFER, screenVBO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBufferData(GL_ARRAY_BUFFER, sizeof(g_screen_vertex_buffer_data), g_screen_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)(3 * sizeof(GLfloat)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>最终显示结果：</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/e2fabf1d21d3bcb698475c4adc3fd233.png" alt="1640529248087" class="img_ev3q"></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="opengl基础" term="opengl基础"/>
        <category label="framebuffe" term="framebuffe"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Blend用法]]></title>
        <id>https://www.iogl.cn/blog/08.Blend用法</id>
        <link href="https://www.iogl.cn/blog/08.Blend用法"/>
        <updated>2021-12-16T22:29:30.000Z</updated>
        <summary type="html"><![CDATA[opengl的blend用于颜色混合 ，如果不用混合，两张贴图贴在一起时，前面的贴图会覆盖后面的贴图，加上混合功能，两张贴图可以很好的贴合在一起。用代码演示一下用法。]]></summary>
        <content type="html"><![CDATA[<p>opengl的blend用于颜色混合 ，如果不用混合，两张贴图贴在一起时，前面的贴图会覆盖后面的贴图，加上混合功能，两张贴图可以很好的贴合在一起。用代码演示一下用法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="blend开启方法">blend开启方法<a href="https://www.iogl.cn/blog/08.Blend%E7%94%A8%E6%B3%95#blend%E5%BC%80%E5%90%AF%E6%96%B9%E6%B3%95" class="hash-link" aria-label="blend开启方法的直接链接" title="blend开启方法的直接链接">​</a></h2>
<p>blend主要使用下面几个函数：</p>
<ul>
<li><code>glEnable(GL_BLEND)</code>: 开启blend功能</li>
<li><code>glBlendFunc(GLenum sfactor, GLenum dfactor)</code>: sfactor源因子，dfactor目标因子</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">示例代码<a href="https://www.iogl.cn/blog/08.Blend%E7%94%A8%E6%B3%95#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="示例代码的直接链接" title="示例代码的直接链接">​</a></h2>
<p>我们先画一个普通场景</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">void display( GLFWwindow* window )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glClearColor( 0, 0, 0.4, 0 );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glUseProgram(boxProgramID);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm::mat4 projection = glm::perspective(glm::radians(45.0f), (float) 5 / (float)5, 0.1f, 100.0f);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm::mat4 view = glm::lookAt(glm::vec3(1,2,3), glm::vec3(0,0,0), glm::vec3(0,1,0));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm::mat4 model = glm::mat4(1.0f);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm::mat4 mvp = projection * view * model;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 1.画地面</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint mvpId = glGetUniformLocation(boxProgramID, "MVP");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glUniformMatrix4fv(mvpId, 1, GL_FALSE, &amp;mvp[0][0]);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(FloorVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindTexture(GL_TEXTURE_2D, floorTexture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glDrawArrays(GL_TRIANGLES, 0, 6);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 2.画立方体</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(VAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindTexture(GL_TEXTURE_2D, texture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glDrawArrays(GL_TRIANGLES, 0, 36);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 3.画blend物体</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model = glm::mat4(1.0f);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model = glm::translate(model, glm::vec3(0, 0, 1.01f));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mvp = projection * view * model;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glUniformMatrix4fv(mvpId, 1, GL_FALSE, &amp;mvp[0][0]);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindTexture(GL_TEXTURE_2D, blendTexture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glDrawArrays(GL_TRIANGLES, 0, 6);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void prepare() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    boxProgramID = LoadShaders( "data/shader/03.MVP.vs", "data/shader/03.MVP.fs" );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    const GLfloat g_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f, -0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f, -0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f, -0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f, -0.5f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f, -0.5f,  1.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.5f,  0.5f,  0.5f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f,  0.5f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -0.5f,  0.5f, -0.5f,  0.0f, 1.0f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float fllor_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            5.0f, -0.5f,  5.0f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -5.0f, -0.5f,  5.0f,  0.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -5.0f, -0.5f, -5.0f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            5.0f, -0.5f,  5.0f,  1.0f, 0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            -5.0f, -0.5f, -5.0f,  0.0f, 1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            5.0f, -0.5f, -5.0f,  1.0f, 1.0f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float blend_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.0f,  0.5f,  0.0f,  0.0f,  0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.0f, -0.5f,  0.0f,  0.0f,  1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            1.0f, -0.5f,  0.0f,  1.0f,  1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            0.0f,  0.5f,  0.0f,  0.0f,  0.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            1.0f, -0.5f,  0.0f,  1.0f,  1.0f,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            1.0f,  0.5f,  0.0f,  1.0f,  0.0f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 1.VAO1、VBO的数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenVertexArrays(1, &amp;VAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(VAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint VBO1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenBuffers(1, &amp;VBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindBuffer(GL_ARRAY_BUFFER, VBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 纹理坐标</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)(3 * sizeof(GLfloat)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 2.地面贴图</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenVertexArrays(1, &amp;FloorVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(FloorVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint VBO2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenBuffers(1, &amp;VBO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindBuffer(GL_ARRAY_BUFFER, VBO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBufferData(GL_ARRAY_BUFFER, sizeof(fllor_vertex_buffer_data), fllor_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 纹理坐标</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)(3 * sizeof(GLfloat)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 2.blend贴图</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenVertexArrays(1, &amp;BlendVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindVertexArray(BlendVAO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint VBO3;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glGenBuffers(1, &amp;VBO3);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBindBuffer(GL_ARRAY_BUFFER, VBO3);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glBufferData(GL_ARRAY_BUFFER, sizeof(blend_vertex_buffer_data), blend_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 纹理坐标</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnableVertexAttribArray(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)(3 * sizeof(GLfloat)));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // 纹理数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    floorTexture = loadTexture("data/img/33.png");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    texture = loadTexture("data/img/11.jpg");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    blendTexture = loadTexture("data/img/chick.png");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glEnable(GL_DEPTH_TEST);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>都是普通贴图操作，显示效果如下：</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/8fdf692cbf38ffeae519a368949c634e.png" alt="1639699366516" class="img_ev3q"></p>
<p>因为是直接贴图覆盖的，所以小鸡周边alpha为0的颜色显示为黑色，如果加上blend功能，则可以看到后面图片的内容了：</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">glEnable(GL_BLEND);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴��板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>最终显示效果：</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/3eddf9c37aea8e93be427111b162f78e.png" alt="1639699653817" class="img_ev3q"></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="opengl基础" term="opengl基础"/>
        <category label="blend" term="blend"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Stencil用法]]></title>
        <id>https://www.iogl.cn/blog/07.Stencil用法</id>
        <link href="https://www.iogl.cn/blog/07.Stencil用法"/>
        <updated>2021-12-15T22:13:01.000Z</updated>
        <summary type="html"><![CDATA[opengl的stencil称为模板测试，和深度测试一样，是Opengl中常用的技术。概念就不解释了，直接演示用法。我们实现对一个立方体盒子进行高亮描边。]]></summary>
        <content type="html"><![CDATA[<p>opengl的stencil称为模板测试，和深度测试一样，是Opengl中常用的技术。概念就不解释了，直接演示用法。我们实现对一个立方体盒子进行高亮描边。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stencil用法">stencil用法<a href="https://www.iogl.cn/blog/07.Stencil%E7%94%A8%E6%B3%95#stencil%E7%94%A8%E6%B3%95" class="hash-link" aria-label="stencil用法的直接链接" title="stencil用法的直接链接">​</a></h2>
<p>stencil最简单的用法是使用下面三个函数：</p>
<ul>
<li><code>glStencilMask(GLuint value)</code>: 位遮罩， 0x00设置模板缓冲不可写入；value=0xFF设置可以写入。</li>
<li><code>glStencilFunc(GLenum func, GLint ref, GLuint mask)</code>: 用ref值与存储的模板值比较，func为比较方法。</li>
<li><code>glStencilOp(GLenum sfail, GLenum dpfail, GLenum dppass)</code>: 模板值的写入策略</li>
</ul>
<p>简单来说，<code>glStencilMask</code>是开关，开了才可以写入模板值；<code>glStencilFunc</code>是写入模板值的前提条件；<code>glStencilOp</code>是模板值的具体写入方法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">示例代码<a href="https://www.iogl.cn/blog/07.Stencil%E7%94%A8%E6%B3%95#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="示例代码的直接链接" title="示例代码的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="普通流程">普通流程<a href="https://www.iogl.cn/blog/07.Stencil%E7%94%A8%E6%B3%95#%E6%99%AE%E9%80%9A%E6%B5%81%E7%A8%8B" class="hash-link" aria-label="普通流程的直接链接" title="普通流程的直接链接">​</a></h3>
<p>我们先准备好了画一个立方体盒子的代码：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint boxProgramID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">display</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> GLFWwindow</span><span class="token operator">*</span><span class="token plain"> window </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glClearColor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glClear</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> GL_COLOR_BUFFER_BIT </span><span class="token operator">|</span><span class="token plain"> GL_DEPTH_BUFFER_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 设置好坐标变化的mvp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 projection </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">perspective</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">radians</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">45.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">float</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">float</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 view </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">lookAt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 model </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">mat4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 mvp </span><span class="token operator">=</span><span class="token plain"> projection </span><span class="token operator">*</span><span class="token plain"> view </span><span class="token operator">*</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 画立方体</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glUseProgram</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">boxProgramID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint mvpId </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">glGetUniformLocation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">boxProgramID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"MVP"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glUniformMatrix4fv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">mvpId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_FALSE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">mvp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glDrawArrays</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TRIANGLES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">36</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">prepare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    boxProgramID </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">LoadShaders</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"data/shader/03.MVP.vs"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"data/shader/03.MVP.fs"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 立方体的顶点坐标，纹理坐标</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> GLfloat g_vertex_buffer_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token number">0.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.0f</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// VAO、VBO的数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint VAO1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint VBO1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glGenVertexArrays</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">VAO1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glBindVertexArray</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">VAO1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glGenBuffers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">VBO1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glBindBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_ARRAY_BUFFER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> VBO1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glBufferData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_ARRAY_BUFFER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">g_vertex_buffer_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> g_vertex_buffer_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_STATIC_DRAW</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glEnableVertexAttribArray</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glVertexAttribPointer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_FLOAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_FALSE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GLfloat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 纹理数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint texture</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glGenTextures</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">texture</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glActiveTexture</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TEXTURE0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glBindTexture</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TEXTURE_2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> texture</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 环绕方式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glTexParameteri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TEXTURE_2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_TEXTURE_WRAP_S</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_REPEAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glTexParameteri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TEXTURE_2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_TEXTURE_WRAP_T</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_REPEAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 过滤方式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glTexParameteri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TEXTURE_2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_TEXTURE_MIN_FILTER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_NEAREST</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glTexParameteri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TEXTURE_2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_TEXTURE_MAG_FILTER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_NEAREST</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 加载图片数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> width</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> height</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> channels</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">stbi_set_flip_vertically_on_load</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">char</span><span class="token operator">*</span><span class="token plain"> data </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">stbi_load</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">"data/img/test.jpg"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">width</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">height</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">channels</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glTexImage2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TEXTURE_2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_RGB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> width</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> height</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_RGB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_UNSIGNED_BYTE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">stbi_image_free</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 纹理坐标</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glEnableVertexAttribArray</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glVertexAttribPointer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_FLOAT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_FALSE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GLfloat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GLfloat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glEnable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_DEPTH_TEST</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">char</span><span class="token operator">*</span><span class="token operator">*</span><span class="token plain"> argv </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glfwInit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLFWwindow</span><span class="token operator">*</span><span class="token plain"> window </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">glfwCreateWindow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token number">512</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">512</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"OpenGL_Tutorial"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">NULL</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glfwMakeContextCurrent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> window </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">gladLoadGLLoader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GLADloadproc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">glfwGetProcAddress </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glfwSwapInterval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glfwSetKeyCallback</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> window</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> keyboard </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glfwSetCursorPosCallback</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> window</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> motion </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glfwSetMouseButtonCallback</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> window</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mouse </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">prepare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">!</span><span class="token function" style="color:rgb(80, 250, 123)">glfwWindowShouldClose</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">display</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">glfwPollEvents</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">glfwSwapBuffers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glfwTerminate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示效果如图：</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/f9fd38ae6d0d360aa8b7cb6c3bfe0f0e.png" alt="1639578757898" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用模板测试功能">使用模板测试功能<a href="https://www.iogl.cn/blog/07.Stencil%E7%94%A8%E6%B3%95#%E4%BD%BF%E7%94%A8%E6%A8%A1%E6%9D%BF%E6%B5%8B%E8%AF%95%E5%8A%9F%E8%83%BD" class="hash-link" aria-label="使用模板测试功能的直接链接" title="使用模板测试功能的直接链接">​</a></h3>
<p>加入模板测试功能，流程描述：</p>
<ol>
<li>开启模板测试</li>
<li>清除所有模板值</li>
<li>画一个立方体盒子，将盒子区域的模板值设置可写，值为1</li>
<li>画一个稍大点的盒子(盒子放大1.05倍)，不贴图，fs里直接设置颜色固定值，进行模板测试，模板测试条件为模板值 != 1，设置模板值不可写。</li>
</ol>
<p>具体代码：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">display</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> GLFWwindow</span><span class="token operator">*</span><span class="token plain"> window </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 1.开启stencil功能</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glEnable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_STENCIL_TEST</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 设置模板值可写，下面的clear GL_STENCIL_BUFFER_BIT操作才能执行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glStencilMask</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0xFF</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 设置模板测试成功的写入方式为替换，即测试成功，使用glStencilFunc中的ref值写入模板值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glStencilOp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_KEEP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_KEEP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_REPLACE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glClearColor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 2.清除深度、模板值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glClear</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> GL_COLOR_BUFFER_BIT </span><span class="token operator">|</span><span class="token plain"> GL_DEPTH_BUFFER_BIT </span><span class="token operator">|</span><span class="token plain"> GL_STENCIL_BUFFER_BIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 3.画立方体</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 projection </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">perspective</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">radians</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">45.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">float</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">float</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.1f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 view </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">lookAt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 model </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">mat4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">mat4 mvp </span><span class="token operator">=</span><span class="token plain"> projection </span><span class="token operator">*</span><span class="token plain"> view </span><span class="token operator">*</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 设置模板值的写入策略，GL_ALWAYS表示无条件写入</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glStencilFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_ALWAYS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0xFF</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glUseProgram</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">boxProgramID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    GLuint mvpId </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">glGetUniformLocation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">boxProgramID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"MVP"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glUniformMatrix4fv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">mvpId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_FALSE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">mvp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glDrawArrays</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TRIANGLES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">36</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 4.画描边</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">mat4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1.0f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 放大盒子为原来的1.05倍</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    model </span><span class="token operator">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">scale</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">vec3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1.05</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.05</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.05</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mvp </span><span class="token operator">=</span><span class="token plain"> projection </span><span class="token operator">*</span><span class="token plain"> view </span><span class="token operator">*</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 进行模板测试，只有不等于1的模板值才测试成功</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glStencilFunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_NOTEQUAL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0xFF</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 设置模板值不可写，此处无需更新模板值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glStencilMask</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0x00</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glUseProgram</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">stencilProgramID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mvpId </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">glGetUniformLocation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">stencilProgramID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"MVP"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glUniformMatrix4fv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">mvpId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> GL_FALSE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">mvp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">glDrawArrays</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">GL_TRIANGLES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">36</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>现在的效果：</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/88e03e838ed2941bffb00b84a0d956da.png" alt="1639579682967" class="img_ev3q"></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="opengl基础" term="opengl基础"/>
        <category label="stencil" term="stencil"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[MVP变换坐标]]></title>
        <id>https://www.iogl.cn/blog/06.MVP变换坐标</id>
        <link href="https://www.iogl.cn/blog/06.MVP变换坐标"/>
        <updated>2021-12-12T17:10:05.000Z</updated>
        <summary type="html"><![CDATA[MVP概念]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mvp概念">MVP概念<a href="https://www.iogl.cn/blog/06.MVP%E5%8F%98%E6%8D%A2%E5%9D%90%E6%A0%87#mvp%E6%A6%82%E5%BF%B5" class="hash-link" aria-label="MVP概念的直接链接" title="MVP概念的直接链接">​</a></h2>
<p>在opengl中，<code>MVP</code>称为模型观察投影矩阵，它是模型（Model）、观察（View）和投影（Projection）矩阵作用在物体上组合作用，用于对物体的坐标系进行变换。</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/a97b8a1c101a53d8bfb26020cc22de2d.png" alt="1639300692250" class="img_ev3q"></p>
<p>如上图所示，物体的坐标系变化过程为：</p>
<ol>
<li>局部坐标系</li>
<li>世界坐标系</li>
<li>观察坐标系</li>
<li>裁剪坐标系</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mvp公式">MVP公式<a href="https://www.iogl.cn/blog/06.MVP%E5%8F%98%E6%8D%A2%E5%9D%90%E6%A0%87#mvp%E5%85%AC%E5%BC%8F" class="hash-link" aria-label="MVP公式的直接链接" title="MVP公式的直接链接">​</a></h2>
<p>$$ MVP=Mprojection⋅Mview⋅Mmodel$$</p>
<p>在shader中用MVP * gl_Position 得到转换后的坐标。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">示例代码<a href="https://www.iogl.cn/blog/06.MVP%E5%8F%98%E6%8D%A2%E5%9D%90%E6%A0%87#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="示例代码的直接链接" title="示例代码的直接链接">​</a></h2>
<p>在<a href="http://iogl.cn/pages/ogltexture/" target="_blank" rel="noopener noreferrer">OpenGL纹理</a>中，介绍了纹理的使用方法，最终的运行效果为：</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/8b0c927d8f7dde56c3955c47c152fc98.png" alt="1637478946876" class="img_ev3q"></p>
<p>修改vertext shader，添加MVP变量</p>
<div class="language-glsl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-glsl codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#version 330 core</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout (location = 0) in vec3 aPos;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout (location = 1) in vec2 aTexCoord;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uniform mat4 MVP;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">out vec2 TexCoord;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void main()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    gl_Position = MVP * vec4(aPos, 1.0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    TexCoord = aTexCoord;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在绘制之前将MVP矩阵传入着色器：</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">glm::mat4 projection = glm::perspective(glm::radians(45.0f), (float) width / (float)height, 0.1f, 100.0f);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glm::mat4 view = glm::lookAt(glm::vec3(1,2,3), glm::vec3(0,0,0), glm::vec3(0,1,0));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glm::mat4 model = glm::mat4(1.0f);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glm::mat4 mvp = projection * view * model;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint mvpId = glGetUniformLocation(programID, "MVP");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glUniformMatrix4fv(mvpId, 1, GL_FALSE, &amp;mvp[0][0]);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>现在的运行效果如下：</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/1beb112d4b8acb155e117a0ba0f25ad2.png" alt="1639310527486" class="img_ev3q"></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="opengl基础" term="opengl基础"/>
        <category label="坐标系" term="坐标系"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[computer shader详解]]></title>
        <id>https://www.iogl.cn/blog/10.computer shader详解</id>
        <link href="https://www.iogl.cn/blog/10.computer shader详解"/>
        <updated>2021-12-08T07:39:25.000Z</updated>
        <summary type="html"><![CDATA[使用方式]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用方式">使用方式<a href="https://www.iogl.cn/blog/10.computer%20shader%E8%AF%A6%E8%A7%A3#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F" class="hash-link" aria-label="使用方式的直接链接" title="使用方式的直接链接">​</a></h2>
<ul>
<li>
<p>代码侧调度计算管线任务</p>
<p><code>vkCmdDIspatch(commandBuffer, groupSize.x, groupSize.y, groupSize.z)</code></p>
<p><code>groupSize</code>代表工作组数量(xyz三个方向上)</p>
</li>
<li>
<p>shader侧配置设置</p>
<p><code>layout(local_size_x=6, local_size_y=4) in;</code></p>
<p>设置本地工作组大小，<code>local_size_z</code>未设置取默认值1</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="workgroup参数说明">WorkGroup参数说明<a href="https://www.iogl.cn/blog/10.computer%20shader%E8%AF%A6%E8%A7%A3#workgroup%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E" class="hash-link" aria-label="WorkGroup参数说明的直接链接" title="WorkGroup参数说明的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/863e1f0932c954536068441fbcf0534f.png" alt="1638971538231" class="img_ev3q"></p>
<p>以上图为例</p>
<ul>
<li>
<p>全局工作组， groupSize.x =3 , groupSize.y=4, groupSize.z=8</p>
</li>
<li>
<p><code>gl_NumWorkGroups</code> ：(3，4，8)，全局工作组大小。</p>
</li>
<li>
<p><code>gl_WorkGroupSize</code> ：(6，4，1)，本地工作组大小。</p>
</li>
<li>
<p><code>gl_WorkGroupID</code> ：（2，2，4），本地工作组在全局工作组中的位置。</p>
</li>
<li>
<p><code>gl_LocalInvocationID</code> ：（5，3，0），计算单元在本地工作组的位置。</p>
</li>
<li>
<p><code>gl_GlobalInvocationID</code> ：（17，11，4），计算单元在全局工作自的位置，gl_WorkGroupID * gl_WorkGroupSize + gl_LocalInvocationID</p>
</li>
<li>
<p><code>gl_LocalInvocationIndex</code> ：23，计算单元在本地工作组的索引，gl_LocalInvocationID.z * gl_WorkGroupSize.x * gl_WorkGroupSize.y + gl_LocalInvocationID.y * gl_WorkGroupSize.x +gl_LocalInvocationID.x;</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="subgroup参数说明">Subgroup参数说明<a href="https://www.iogl.cn/blog/10.computer%20shader%E8%AF%A6%E8%A7%A3#subgroup%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E" class="hash-link" aria-label="Subgroup参数说明的直接链接" title="Subgroup参数说明的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/c349681166b76d3a822788989b02ac22.png" alt="1638972921886" class="img_ev3q"></p>
<p>如果一个本地工作组分成如上图所示的subgroup，则有如下参数</p>
<ul>
<li>
<p><code>gl_NumSubgroups</code>  ：8，本地工作组内的子组数</p>
</li>
<li>
<p><code>gl_SubgroupID</code>  ：[0，7]，本地工作组内子组的ID，范围[0，gl_NumSubgroups)</p>
</li>
<li>
<p><code>gl_SubgroupSize</code>  ：32，子组的容量大小</p>
</li>
<li>
<p><code>gl_SubgroupInvocationID</code>  ：[0，31]，子组内计算单元的ID，范围[0，gl_SubgroupSize)</p>
</li>
</ul>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="computer shader" term="computer shader"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[OpenGL纹理]]></title>
        <id>https://www.iogl.cn/blog/05.OpenGL纹理</id>
        <link href="https://www.iogl.cn/blog/05.OpenGL纹理"/>
        <updated>2021-11-21T13:57:08.000Z</updated>
        <summary type="html"><![CDATA[简介]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="简介">简介<a href="https://www.iogl.cn/blog/05.OpenGL%E7%BA%B9%E7%90%86#%E7%AE%80%E4%BB%8B" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h2>
<p>opengl纹理简单来说就是贴图，像2D游戏，就是用大量的贴图拼起来组成丰富多彩的画面。下面我们详细地描述一下使用纹理的代码方式。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">示例代码<a href="https://www.iogl.cn/blog/05.OpenGL%E7%BA%B9%E7%90%86#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="示例代码的直接链接" title="示例代码的直接链接">​</a></h2>
<p>顶点着色器输入两组坐标，顶点坐标和纹理坐标，纹理坐标直接传递给片段着色器</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//02.Texture.vs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#version 330 core</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout (location = 0) in vec3 aPos;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">layout (location = 1) in vec2 aTexCoord;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">out vec2 TexCoord;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void main()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    gl_Position = vec4(aPos, 1.0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    TexCoord = aTexCoord;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>片段着色器定义一个纹理采样器text1，它与代码中绑定的TEXTURE0关联，使用传入的纹理坐标采样</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//02.Texture.fs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#version 330 core</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">in vec2 TexCoord;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uniform sampler2D tex1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">out vec4 FragColor;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void main()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    FragColor = texture(tex1, TexCoord);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>实现代码逻辑</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint programID = LoadShaders( "data/shader/02.Texture.vs", "data/shader/02.Texture.fs" );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glUseProgram(programID);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 顶点、纹理坐标</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">const GLfloat g_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -0.5f, -0.5f, 0.0f, 0.0f, 0.0f,    // 左下角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    0.5f, -0.5f, 0.0f,  1.0f, 0.0f,    // 右下角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -0.5f, 0.5f, 0.0f,  0.0f, 1.0f,    // 左上角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    0.5f, 0.5f, 0.0f,   1.0f, 1.0f     // 右上角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 顶点索引</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unsigned int indices[] = {0, 1, 2,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          1, 2, 3};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// VAO1、VBO1、EBO1的数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint VAO1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint VBO1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint EBO1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenVertexArrays(1, &amp;VAO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindVertexArray(VAO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenBuffers(1, &amp;VBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindBuffer(GL_ARRAY_BUFFER, VBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenBuffers(1, &amp;EBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 纹理数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint texture;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenTextures(1, &amp;texture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glActiveTexture(GL_TEXTURE0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindTexture(GL_TEXTURE_2D, texture);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 环绕方式</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 过滤方式</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 加载图片数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int width, height, channels;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 图像坐标系与纹理坐标系相反，翻转y轴</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stbi_set_flip_vertically_on_load(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unsigned char* data = stbi_load("data/img/test.jpg", &amp;width, &amp;height, &amp;channels, 0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, width, height, 0, GL_RGB, GL_UNSIGNED_BYTE, data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stbi_image_free(data);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 纹理坐标</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glEnableVertexAttribArray(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(GLfloat), (void*)(3 * sizeof(GLfloat)));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>运行效果：</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/8b0c927d8f7dde56c3955c47c152fc98.png" alt="1637478946876" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="环绕方式">环绕方式<a href="https://www.iogl.cn/blog/05.OpenGL%E7%BA%B9%E7%90%86#%E7%8E%AF%E7%BB%95%E6%96%B9%E5%BC%8F" class="hash-link" aria-label="环绕方式的直接链接" title="环绕方式的直接链接">​</a></h2>
<p>通过设置<code>GL_TEXTURE_WRAP_</code>参数来设置环绕方式</p>
<ul>
<li>
<p><code>GL_REPEAT</code>: 超出纹理范围的坐标整数部分被忽略，形成重复效果。</p>
</li>
<li>
<p><code>GL_MIRRORED_REPEAT</code>: 超出纹理范围的坐标整数部分被忽略，但当整数部分为奇数时进行取反，形成镜像效果。</p>
</li>
<li>
<p><code>GL_CLAMP_TO_EDGE</code>: 超出纹理范围的坐标被截取成0和1，形成纹理边缘延伸的效果。</p>
</li>
<li>
<p><code>GL_CLAMP_TO_BORDER</code>:  超出纹理范围的部分被设置为边缘色。</p>
</li>
</ul>
<p>如果将纹理坐标改成如下:</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">const GLfloat g_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -0.5f, -0.5f, 0.0f, 0.0f, 0.0f,    // 左下角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    0.5f, -0.5f, 0.0f,  2.0f, 0.0f,    // 右下角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -0.5f, 0.5f, 0.0f,  0.0f, 2.0f,    // 左上角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    0.5f, 0.5f, 0.0f,   2.0f, 2.0f     // 右上角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>不同环绕方式对应的效果:</p>
<p>GL_REPEAT</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/8584304f0436687612292cb33ae09398.png" alt="11" class="img_ev3q"></p>
<hr>
<p>GL_MIRRORED_REPEAT</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/eb72316da29dc70f706915510134e249.png" alt="222" class="img_ev3q"></p>
<hr>
<p>GL_CLAMP_TO_EDGE</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/4c7b53d0f1df36e720ff66a1055eaf64.png" alt="333" class="img_ev3q"></p>
<hr>
<p>GL_CLAMP_TO_BORDER</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/99d5651bbf052ab5d6a9d51e68755122.png" alt="444" class="img_ev3q"></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="opengl基础" term="opengl基础"/>
        <category label="纹理" term="纹理"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[OpenGL中的坐标系统]]></title>
        <id>https://www.iogl.cn/blog/04.OpenGL中的坐标系统</id>
        <link href="https://www.iogl.cn/blog/04.OpenGL中的坐标系统"/>
        <updated>2021-11-20T21:16:27.000Z</updated>
        <summary type="html"><![CDATA[常见的坐标系统]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="常见的坐标系统">常见的坐标系统<a href="https://www.iogl.cn/blog/04.OpenGL%E4%B8%AD%E7%9A%84%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F" class="hash-link" aria-label="常见的坐标系统的直接链接" title="常见的坐标系统的直接链接">​</a></h2>
<p>opengl的坐标系用一张图概要说明</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/2f524724f059a8a20ae0c933e541a0fc.png" alt="1637416960591" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="世界坐标系">世界坐标系<a href="https://www.iogl.cn/blog/04.OpenGL%E4%B8%AD%E7%9A%84%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F#%E4%B8%96%E7%95%8C%E5%9D%90%E6%A0%87%E7%B3%BB" class="hash-link" aria-label="世界坐标系的直接链接" title="世界坐标系的直接链接">​</a></h3>
<p>在 OpenGL 中，3D世界坐标系采用的是右手笛卡尔坐标系。</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/ecb4a55ead119d5928c36cddb0999b5a.png" alt="1637416191561" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="屏幕坐标系">屏幕坐标系<a href="https://www.iogl.cn/blog/04.OpenGL%E4%B8%AD%E7%9A%84%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F#%E5%B1%8F%E5%B9%95%E5%9D%90%E6%A0%87%E7%B3%BB" class="hash-link" aria-label="屏幕坐标系的直接链接" title="屏幕坐标系的直接链接">​</a></h3>
<p>屏幕坐标系，大部分是以左上角为原点（0，0）的。 代表的操作系统有Windows，Android，Symbian，iOS 的Core Graphics。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="opengl-2d坐标系">OpenGL 2D坐标系<a href="https://www.iogl.cn/blog/04.OpenGL%E4%B8%AD%E7%9A%84%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F#opengl-2d%E5%9D%90%E6%A0%87%E7%B3%BB" class="hash-link" aria-label="OpenGL 2D坐标系的直接链接" title="OpenGL 2D坐标系的直接链接">​</a></h3>
<p>OpenGL绘制时采用NDC坐标系，NDC就是设备标准化坐标系 ， 原点在屏幕中心，坐标范围[-1，1]</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/bb5f6489c26630c49f7215bda6d21ab8.png" alt="1637415339038" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="窗口坐标系">窗口坐标系<a href="https://www.iogl.cn/blog/04.OpenGL%E4%B8%AD%E7%9A%84%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F#%E7%AA%97%E5%8F%A3%E5%9D%90%E6%A0%87%E7%B3%BB" class="hash-link" aria-label="窗口坐标系的直接链接" title="窗口坐标系的直接链接">​</a></h3>
<p>也叫视口坐标系， 原点在左下角，X、Y 轴分别向右和向上，采用和屏幕坐标一样的像素计算长度。 在 OpenGL 中，我们使用接口 glViewport 设置视口</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/e9e646c59ba2e6efd398d8d6765187c1.png" alt="1637416580747" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="纹理坐标系">纹理坐标系<a href="https://www.iogl.cn/blog/04.OpenGL%E4%B8%AD%E7%9A%84%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F#%E7%BA%B9%E7%90%86%E5%9D%90%E6%A0%87%E7%B3%BB" class="hash-link" aria-label="纹理坐标系的直接链接" title="纹理坐标系的直接链接">​</a></h3>
<p>纹理坐标的原点在纹理左下角，<code>x</code>轴向右，<code>y</code>轴向上，<code>x</code>和<code>y</code>的取值范围都是0到1。</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/58e9b249068cf37e5ad5e1e93056ebb4.png" alt="1637415544184" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="图片坐标系">图片坐标系<a href="https://www.iogl.cn/blog/04.OpenGL%E4%B8%AD%E7%9A%84%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F#%E5%9B%BE%E7%89%87%E5%9D%90%E6%A0%87%E7%B3%BB" class="hash-link" aria-label="图片坐标系的直接链接" title="图片坐标系的直接链接">​</a></h3>
<p>图片坐标系的原点在图片左上角，<code>x</code>轴向右，<code>y</code>轴向下，<code>x</code>和<code>y</code>的取值范围都是0到对应的图片宽高。</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/4441ece5077a11c6903dfbaf0adc7f89.png" alt="1637415525917" class="img_ev3q"></p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="opengl基础" term="opengl基础"/>
        <category label="坐标系" term="坐标系"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[浅谈VAO、VBO、VEO]]></title>
        <id>https://www.iogl.cn/blog/03.浅谈VAO、VBO、VEO</id>
        <link href="https://www.iogl.cn/blog/03.浅谈VAO、VBO、VEO"/>
        <updated>2021-11-18T07:35:01.000Z</updated>
        <summary type="html"><![CDATA[概念说明]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="概念说明">概念说明<a href="https://www.iogl.cn/blog/03.%E6%B5%85%E8%B0%88VAO%E3%80%81VBO%E3%80%81VEO#%E6%A6%82%E5%BF%B5%E8%AF%B4%E6%98%8E" class="hash-link" aria-label="概念说明的直接链接" title="概念说明的直接链接">​</a></h2>
<p>在opengl中，VAO,VBO,VEO都是存储顶点数据的缓冲对象，解释如下：</p>
<ul>
<li>顶点数组对象：Vertex Array Object，VAO</li>
<li>顶点缓冲对象：Vertex Buffer Object，VBO</li>
<li>索引缓冲对象：Element Buffer Object，EBO或Index Buffer Object，IBO</li>
</ul>
<p>这三个缓冲对象的关系图：</p>
<p><img decoding="async" loading="lazy" src="https://objectstorage.ap-osaka-1.oraclecloud.com/n/ax0kqy8quzyr/b/bucket-blog/o/2022/04/3c91e78070193e053a8588f8f91c6939.png" alt="1635954045960" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="顶点数组对象vao">顶点数组对象(VAO)<a href="https://www.iogl.cn/blog/03.%E6%B5%85%E8%B0%88VAO%E3%80%81VBO%E3%80%81VEO#%E9%A1%B6%E7%82%B9%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1vao" class="hash-link" aria-label="顶点数组对象(VAO)的直接链接" title="顶点数组对象(VAO)的直接链接">​</a></h3>
<p>顶点数组对象(Vertex Array Object, VAO)可以像顶点缓冲对象那样被绑定，任何随后的顶点属性调用都会储存在这个VAO中。这样的好处就是，当配置顶点属性指针时，你只需要将那些调用执行一次，之后再绘制物体的时候只需要绑定相应的VAO就行了。这使在不同顶点数据和属性配置之间切换变得非常简单，只需要绑定不同的VAO就行了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="顶点缓冲对象vbo">顶点缓冲对象(VBO)<a href="https://www.iogl.cn/blog/03.%E6%B5%85%E8%B0%88VAO%E3%80%81VBO%E3%80%81VEO#%E9%A1%B6%E7%82%B9%E7%BC%93%E5%86%B2%E5%AF%B9%E8%B1%A1vbo" class="hash-link" aria-label="顶点缓冲对象(VBO)的直接链接" title="顶点缓冲对象(VBO)的直接链接">​</a></h3>
<p>我们通过顶点缓冲对象(Vertex Buffer Objects, VBO)管理内存，它会在GPU内存(通常被称为显存)中储存大批顶点。使用这些缓冲对象的好处是我们可以一次性的发送一大批数据到显卡上，而不是每个顶点发送一次。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="索引缓冲对象ebo">索引缓冲对象(EBO)<a href="https://www.iogl.cn/blog/03.%E6%B5%85%E8%B0%88VAO%E3%80%81VBO%E3%80%81VEO#%E7%B4%A2%E5%BC%95%E7%BC%93%E5%86%B2%E5%AF%B9%E8%B1%A1ebo" class="hash-link" aria-label="索引缓冲对象(EBO)的直接链接" title="索引缓冲对象(EBO)的直接链接">​</a></h3>
<p>和顶点缓冲对象一样，EBO也是一个缓冲，它专门储存索引，OpenGL调用这些顶点的索引来决定该绘制哪个顶点。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="三者关系">三者关系<a href="https://www.iogl.cn/blog/03.%E6%B5%85%E8%B0%88VAO%E3%80%81VBO%E3%80%81VEO#%E4%B8%89%E8%80%85%E5%85%B3%E7%B3%BB" class="hash-link" aria-label="三者关系的直接链接" title="三者关系的直接链接">​</a></h2>
<p><strong>可以理解为VBO就是显存中的一个存储区域，可以保持大量的顶点属性信息</strong>。并且可以开辟很多个VBO，每个VBO在OpenGL中有它的唯一标识ID，这个ID对应着具体的VBO的显存地址，通过这个ID可以对特定的VBO内的数据进行存取操作。</p>
<p><strong>VAO是一个保存了所有顶点数据属性的状态结合，它存储了顶点数据的格式以及顶点数据所需的VBO对象的引用</strong>。VAO本身并没有存储顶点的相关属性数据，这些信息是存储在VBO中的，VAO相当于是对很多个VBO的引用，把一些VBO组合在一起作为一个对象统一管理。</p>
<p><strong>EBO中存储的内容就是顶点位置的索引indices，EBO跟VBO类似，也是在显存中的一块内存缓冲器</strong>，只不过EBO保存的是顶点的索引。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例代码">示例代码<a href="https://www.iogl.cn/blog/03.%E6%B5%85%E8%B0%88VAO%E3%80%81VBO%E3%80%81VEO#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" class="hash-link" aria-label="示例代码的直接链接" title="示例代码的直接链接">​</a></h2>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">const GLfloat g_vertex_buffer_data[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -1.0f, -1.0f, 0.0f,     // 左下角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    1.0f, -1.0f, 0.0f,      // 右下角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    0.0f, 0.0f, 0.0f,       // 中间点</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -1.0f, 1.0f, 0.0f,      // 左上角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    1.0f, 1.0f, 0.0f        // 右上角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unsigned int indices1[] = {0, 1, 2};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unsigned int indices2[] = {2, 3, 4};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// VAO1、VBO1、EBO1的数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint VAO1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint VBO1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint EBO1;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenVertexArrays(1, &amp;VAO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindVertexArray(VAO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenBuffers(1, &amp;VBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindBuffer(GL_ARRAY_BUFFER, VBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenBuffers(1, &amp;EBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices1), indices1, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// VAO2、VBO2、EBO2的数据</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint VAO2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint VBO2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLuint EBO2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenVertexArrays(1, &amp;VAO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindVertexArray(VAO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenBuffers(1, &amp;VBO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindBuffer(GL_ARRAY_BUFFER, VBO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glGenBuffers(1, &amp;EBO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices2), indices2, GL_STATIC_DRAW);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (void*)0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glClearColor( 0, 0, 0.4, 0 );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 绑定VAO1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindVertexArray(1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_INT, 0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 绑定VAO2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glBindVertexArray(2);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_INT, 0);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上面的示例代码，首先设置好VAO1、VAO2的缓冲数据，VAO中分别绑定对应的VBO、EBO，后面在绘制前直接绑定对应的VAO即可。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="简单的绘制方式">简单的绘制方式<a href="https://www.iogl.cn/blog/03.%E6%B5%85%E8%B0%88VAO%E3%80%81VBO%E3%80%81VEO#%E7%AE%80%E5%8D%95%E7%9A%84%E7%BB%98%E5%88%B6%E6%96%B9%E5%BC%8F" class="hash-link" aria-label="简单的绘制方式的直接链接" title="简单的绘制方式的直接链接">​</a></h2>
<p>如果给了一组顶点信息，可使用下面的两种方式绘制，两种方式是等效的：</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">const GLfloat points[] = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -1.0f, -1.0f, 0.0f,     // 左下角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    1.0f, -1.0f, 0.0f,      // 右下角</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    0.0f, 0.0f, 0.0f,       // 中间点</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 方式一</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glEnableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, points);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glDrawArrays(GL_TRIANGLES, 0, 3);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glDisableVertexAttribArray(0);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 方式二</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glEnableClientState(GL_VERTEX_ARRAY);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glVertexPointer(3, GL_FLOAT, 0, points);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glDrawArrays(GL_TRIANGLES, 0, 3);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">glDisableClientState(GL_VERTEX_ARRAY);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="opengl基础" term="opengl基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[收集的OpenGL资源]]></title>
        <id>https://www.iogl.cn/blog/01.收集的OpenGL资源</id>
        <link href="https://www.iogl.cn/blog/01.收集的OpenGL资源"/>
        <updated>2021-11-02T22:54:31.000Z</updated>
        <summary type="html"><![CDATA[收集的OpenGL资源]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="收集的opengl资源">收集的OpenGL资源<a href="https://www.iogl.cn/blog/01.%E6%94%B6%E9%9B%86%E7%9A%84OpenGL%E8%B5%84%E6%BA%90#%E6%94%B6%E9%9B%86%E7%9A%84opengl%E8%B5%84%E6%BA%90" class="hash-link" aria-label="收集的OpenGL资源的直接链接" title="收集的OpenGL资源的直接链接">​</a></h2>
<p><a href="https://www.khronos.org/opengl/wiki/Getting_Started" target="_blank" rel="noopener noreferrer">OpenGL官方指引</a></p>
<p><a href="http://www.zwqxin.com/" target="_blank" rel="noopener noreferrer">ZwqXin</a></p>
<p><a href="https://learnopengl-cn.github.io/" target="_blank" rel="noopener noreferrer">LearnOpenGL中文教程</a></p>
<p><a href="https://developer.nvidia.com/gpugems/gpugems/contributors" target="_blank" rel="noopener noreferrer">NVIDIA GPU Gems</a></p>
<p><a href="https://www.cnblogs.com/hackpig/tag/OpenGL/" target="_blank" rel="noopener noreferrer">猪悟能'S博客</a></p>
<p><a href="https://blog.csdn.net/jxw167/column/info/14637" target="_blank" rel="noopener noreferrer">OpenGL核心技术</a></p>
<p><a href="https://github.com/sumcai/GLSL-Card" target="_blank" rel="noopener noreferrer">GLSL中文手册</a></p>
<p><a href="https://pbr-book.org/3ed-2018/contents" target="_blank" rel="noopener noreferrer">Physically Based Rendering</a></p>
<p><a href="https://user.xmission.com/~nate/tutors.html" target="_blank" rel="noopener noreferrer">Tutors example</a></p>
<p>未完待续~</p>]]></content>
        <author>
            <name>苏明才</name>
            <email>sumcai@163.com</email>
            <uri>https://github.com/sumcai</uri>
        </author>
        <category label="opengl基础" term="opengl基础"/>
    </entry>
</feed>