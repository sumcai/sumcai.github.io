"use strict";(self.webpackChunkvulkan_doc=self.webpackChunkvulkan_doc||[]).push([[9724],{7730:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>m,default:()=>f,frontMatter:()=>i,metadata:()=>a,toc:()=>u});var r=t(4848),o=t(8453);const i={title:"\u521b\u5efamvp ubo",categories:["Vulkan\u6280\u672f"],tags:["\u56fe\u5f62\u57fa\u7840"],date:new Date("2024-08-01T15:47:18.000Z"),authors:"sumcai"},m="\u521b\u5efamvp ubo(uniform buffer object)",a={permalink:"/blog/15.\u521b\u5efamvp ubo",source:"@site/blog/15.\u521b\u5efamvp ubo.md",title:"\u521b\u5efamvp ubo",description:"\u521b\u5efa\u8fc7\u7a0b",date:"2024-08-01T15:47:18.000Z",tags:[{inline:!0,label:"\u56fe\u5f62\u57fa\u7840",permalink:"/blog/tags/\u56fe\u5f62\u57fa\u7840"}],readingTime:1.04,hasTruncateMarker:!1,authors:[{name:"\u82cf\u660e\u624d",title:"Vulkan\u9a71\u52a8\u586b\u5751\u72ee",url:"https://github.com/sumcai",email:"sumcai@163.com",page:{permalink:"/blog/authors/sumcai"},description:"\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u8bf7\u8054\u7cfb sumcai@163.com",socials:{github:"https://github.com/sumcai"},imageURL:"https://avatars.githubusercontent.com/u/76768485?v=4",key:"sumcai"}],frontMatter:{title:"\u521b\u5efamvp ubo",categories:["Vulkan\u6280\u672f"],tags:["\u56fe\u5f62\u57fa\u7840"],date:"2024-08-01T15:47:18.000Z",authors:"sumcai"},unlisted:!1,prevItem:{title:"\u521b\u5efadepth/stencil attachment",permalink:"/blog/14.\u521b\u5efadepthstencil attachment"},nextItem:{title:"Vulkan vertex buffer\u7ed1\u5b9a\u8fc7\u7a0b",permalink:"/blog/13.Vulkan vertex buffer\u7ed1\u5b9a\u8fc7\u7a0b"}},l={authorsImageUrls:[void 0]},u=[{value:"\u521b\u5efa\u8fc7\u7a0b",id:"\u521b\u5efa\u8fc7\u7a0b",level:2},{value:"\u793a\u4f8b\u4ee3\u7801",id:"\u793a\u4f8b\u4ee3\u7801",level:2}];function c(e){const n={code:"code",h2:"h2",li:"li",ol:"ol",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u521b\u5efa\u8fc7\u7a0b",children:"\u521b\u5efa\u8fc7\u7a0b"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u521b\u5efa\u4e00\u4e2auniform buffer"}),"\n",(0,r.jsx)(n.li,{children:"\u67e5\u627ebuffer memory requirements"}),"\n",(0,r.jsx)(n.li,{children:"\u5206\u914d\u3001\u7ed1\u5b9abuffer memory"}),"\n",(0,r.jsx)(n.li,{children:"map buffer memory"}),"\n",(0,r.jsx)(n.li,{children:"\u62f7\u8d1dmvp data to buffer memory"}),"\n",(0,r.jsx)(n.li,{children:"unmap buffer memory"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u793a\u4f8b\u4ee3\u7801",children:"\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"glm::mat4 projection = glm::perspective(glm::radians(45.0f), 1.0f, 0.1f, 100.0f);\r\nglm::mat4 view = glm::lookAt(\r\n\t\t\t\t\tglm::vec3(-5, 3, -10),  // \u76f8\u673a\u5728\u4e16\u754c\u5750\u6807\u7cfb\u4e2d\u7684\u4f4d\u7f6e\r\n\t\t\t\t\tglm::vec3(0, 0, 0),     // \u770b\u5411\u7684\u76ee\u6807\u4f4d\u7f6e\r\n\t\t\t\t\tglm::vec3(0, -1, 0)     // \u76f8\u673aup\u65b9\u5411\u5411\u91cf\r\n\t\t\t\t );\r\nglm::mat4 model = glm::mat4(1.0f);\r\nglm::mat4 clip = glm::mat4(1.0f, 0.0f, 0.0f, 0.0f,\r\n\t\t\t\t\t  0.0f,-1.0f, 0.0f, 0.0f,\r\n\t\t\t\t\t  0.0f, 0.0f, 0.5f, 0.0f,\r\n\t\t\t\t\t  0.0f, 0.0f, 0.5f, 1.0f);\r\nglm::mat4 mvp = clip * projection * view * model;\r\n \r\nVkBuffer ubo;\r\nVkBufferCreateInfo buf_info = {};\r\nbuf_info.sType = VK_STRUCTURE_TYPE_BUFFER_CREATE_INFO;\r\nbuf_info.pNext = NULL;\r\nbuf_info.usage = VK_BUFFER_USAGE_UNIFORM_BUFFER_BIT;\r\nbuf_info.size = sizeof(mvp);\r\nbuf_info.queueFamilyIndexCount = 0;\r\nbuf_info.pQueueFamilyIndices = NULL;\r\nbuf_info.sharingMode = VK_SHARING_MODE_EXCLUSIVE;\r\nbuf_info.flags = 0;\r\nvkCreateBuffer(device, &buf_info, NULL, &ubo);\r\n \r\nVkMemoryRequirements mem_reqs;\r\nvkGetBufferMemoryRequirements(device, ubo, &mem_reqs);\r\n \r\nVkDeviceMemory mem;\r\nVkMemoryAllocateInfo alloc_info = {};\r\nalloc_info.sType = VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO;\r\nalloc_info.pNext = NULL;\r\nalloc_info.memoryTypeIndex = 0;\r\nalloc_info.allocationSize = mem_reqs.size;\r\nvkAllocateMemory(device, &alloc_info, NULL, &mem);\r\n \r\nvkBindBufferMemory(device, ubo, mem, 0);\r\n \r\nuint8_t *pData;\r\nvkMapMemory(device, mem, 0, mem_reqs.size, 0, (void **)&pData);\r\n \r\nmemcpy(pData, &mvp, sizeof(mvp));\r\n \r\nvkUnmapMemory(device, mem);\n"})})]})}function f(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>m,x:()=>a});var r=t(6540);const o={},i=r.createContext(o);function m(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:m(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);