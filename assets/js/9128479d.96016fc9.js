"use strict";(self.webpackChunkvulkan_doc=self.webpackChunkvulkan_doc||[]).push([[6011],{280:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>a,frontMatter:()=>o,metadata:()=>s,toc:()=>t});var i=r(4848),l=r(8453);const o={title:"vkCmdBeginQuery",description:"vkCmdBeginQuery"},d=":material-chevron-right-circle: vkCmdBeginQuery",s={id:"api/vkCmdBeginQuery",title:"vkCmdBeginQuery",description:"vkCmdBeginQuery",source:"@site/docs/api/vkCmdBeginQuery.md",sourceDirName:"api",slug:"/api/vkCmdBeginQuery",permalink:"/api/vkCmdBeginQuery",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"vkCmdBeginQuery",description:"vkCmdBeginQuery"},sidebar:"VulkanApi",previous:{title:"vkBindImageMemory",permalink:"/api/vkBindImageMemory"},next:{title:"vkCmdBeginRenderPass",permalink:"/api/vkCmdBeginRenderPass"}},c={},t=[{value:"\u51fd\u6570\u539f\u578b",id:"\u51fd\u6570\u539f\u578b",level:2},{value:"\u63cf\u8ff0",id:"\u63cf\u8ff0",level:2},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:2},{value:"\u8865\u5145",id:"\u8865\u5145",level:2},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c",level:2},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b",level:2}];function u(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"material-chevron-right-circle-vkcmdbeginquery",children:":material-chevron-right-circle: vkCmdBeginQuery"})}),"\n",(0,i.jsx)(n.h2,{id:"\u51fd\u6570\u539f\u578b",children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"void vkCmdBeginQuery(\r\n    VkCommandBuffer                             commandBuffer,\r\n    VkQueryPool                                 queryPool,\r\n    uint32_t                                    query,\r\n    VkQueryControlFlags                         flags);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u63cf\u8ff0",children:"\u63cf\u8ff0"}),"\n",(0,i.jsx)(n.p,{children:"\u5f00\u59cb\u67e5\u8be2\u64cd\u4f5c\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"commandBuffer"})," : \u5f55\u5236\u6307\u4ee4\u7684\u547d\u4ee4\u7f13\u51b2\u533a\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"queryPool"})," : \u7ba1\u7406\u67e5\u8be2\u7ed3\u679c\u7684\u67e5\u8be2\u6c60\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"query"})," : \u5728\u67e5\u8be2\u6c60\u4e2d\u7684\u7d22\u5f15\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"flags"})," : ",(0,i.jsx)(n.code,{children:"VkQueryControlFlagBits"}),"\u7684\u63a9\u7801\uff0c\u6307\u5b9a\u67e5\u8be2\u7684\u7ea6\u675f\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u8865\u5145",children:"\u8865\u5145"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"VkQueryControlFlagBits"})," \u679a\u4e3e\u5b9a\u4e49\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"typedef enum VkQueryControlFlagBits {\r\n    VK_QUERY_CONTROL_PRECISE_BIT = 0x00000001,\r\n} VkQueryControlFlagBits;\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"VK_QUERY_CONTROL_PRECISE_BIT"})," : \u6307\u5b9aocclusion query(\u906e\u6321\u67e5\u8be2)\u7ed3\u679c\u7684\u7cbe\u5ea6","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u542f\u7528\u65f6\uff08PRECISE_BIT\uff09\uff1a\u67e5\u8be2\u7ed3\u679c\u4fdd\u8bc1\u7cbe\u786e\uff0c\u4f46\u53ef\u80fd\u4f1a\u964d\u4f4e\u6027\u80fd\u3002"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u7981\u7528\u65f6\uff08\u9ed8\u8ba4\uff09\uff1a\u67e5\u8be2\u7ed3\u679c\u53ef\u80fd\u662f\u8fd1\u4f3c\u503c\uff0c\u4f46\u6027\u80fd\u66f4\u9ad8\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u9002\u7528\u573a\u666f"}),"\uff1a\u5f53\u9700\u8981\u51c6\u786e\u7684\u50cf\u7d20\u901a\u8fc7\u6570\uff08\u4f8b\u5982\u7cbe\u786e\u7684\u906e\u6321\u5254\u9664\u3001\u6027\u80fd\u5206\u6790\uff09\u65f6\u542f\u7528\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u8fd4\u56de\u503c",children:"\u8fd4\u56de\u503c"}),"\n",(0,i.jsx)(n.p,{children:"\u65e0"}),"\n",(0,i.jsx)(n.h2,{id:"\u4ee3\u7801\u793a\u4f8b",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"VkQueryPoolCreateInfo queryPoolInfo = {};\r\nqueryPoolInfo.sType = VK_STRUCTURE_TYPE_QUERY_POOL_CREATE_INFO;\r\nqueryPoolInfo.queryType = VK_QUERY_TYPE_OCCLUSION;  // \u906e\u6321\u67e5\u8be2\u7c7b\u578b\r\nqueryPoolInfo.queryCount = 1;\r\n\r\n// \u542f\u7528 PRECISE_BIT\r\nqueryPoolInfo.flags = VK_QUERY_CONTROL_PRECISE_BIT;\r\n\r\nVkQueryPool queryPool;\r\nvkCreateQueryPool(device, &queryPoolInfo, nullptr, &queryPool);\r\n\r\nvkCmdBeginQuery(\r\n    commandBuffer,\r\n    queryPool,\r\n    0,  // \u67e5\u8be2\u7d22\u5f15\r\n    VK_QUERY_CONTROL_PRECISE_BIT  // \u542f\u7528\u7cbe\u786e\u67e5\u8be2\r\n);\r\n\r\n// \u7ed8\u5236\u9700\u8981\u6d4b\u8bd5\u7684\u51e0\u4f55\u4f53\r\nvkCmdDrawIndexed(commandBuffer, ...);\r\n\r\nvkCmdEndQuery(commandBuffer, queryPool, 0);\r\n\r\n// \u83b7\u53d6\u67e5\u8be2\u7ed3\u679c\r\nuint64_t result;\r\nvkGetQueryPoolResults(\r\n    device,\r\n    queryPool,\r\n    0, 1, sizeof(uint64_t),\r\n    &result, sizeof(uint64_t),\r\n    VK_QUERY_RESULT_64_BIT | VK_QUERY_RESULT_WAIT_BIT\r\n);\r\n\n"})})]})}function a(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>s});var i=r(6540);const l={},o=i.createContext(l);function d(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);