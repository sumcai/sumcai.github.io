"use strict";(self.webpackChunkvulkan_doc=self.webpackChunkvulkan_doc||[]).push([[5351],{1616:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>m,frontMatter:()=>l,metadata:()=>r,toc:()=>c});var o=t(4848),i=t(8453);const l={title:"vkCreateCommandPool",description:"vkCreateCommandPool"},a="vkCreateCommandPool",r={id:"api/vkCreateCommandPool",title:"vkCreateCommandPool",description:"vkCreateCommandPool",source:"@site/docs/api/vkCreateCommandPool.md",sourceDirName:"api",slug:"/api/vkCreateCommandPool",permalink:"/api/vkCreateCommandPool",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"vkCreateCommandPool",description:"vkCreateCommandPool"},sidebar:"VulkanApi",previous:{title:"vkCreateBuffer",permalink:"/api/vkCreateBuffer"},next:{title:"vkCreateDevice",permalink:"/api/vkCreateDevice"}},d={},c=[{value:"\u51fd\u6570\u539f\u578b",id:"\u51fd\u6570\u539f\u578b",level:2},{value:"\u63cf\u8ff0",id:"\u63cf\u8ff0",level:2},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:2},{value:"\u8865\u5145",id:"\u8865\u5145",level:2},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c",level:2},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b",level:2}];function s(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"vkcreatecommandpool",children:"vkCreateCommandPool"})}),"\n",(0,o.jsx)(n.h2,{id:"\u51fd\u6570\u539f\u578b",children:"\u51fd\u6570\u539f\u578b"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-c",children:"VkResult vkCreateCommandPool(\n    VkDevice                                    device,\n    const VkCommandPoolCreateInfo*              pCreateInfo,\n    const VkAllocationCallbacks*                pAllocator,\n    VkCommandPool*                              pCommandPool);\n"})}),"\n",(0,o.jsx)(n.h2,{id:"\u63cf\u8ff0",children:"\u63cf\u8ff0"}),"\n",(0,o.jsx)(n.p,{children:"\u521b\u5efa\u547d\u4ee4\u7f13\u51b2\u6c60\u3002"}),"\n",(0,o.jsx)(n.h2,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"device"})," : \u7528\u4e8e\u521b\u5efa\u547d\u4ee4\u7f13\u51b2\u6c60\u7684\u903b\u8f91\u8bbe\u5907\u3002"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"pCreateInfo"})," : ",(0,o.jsx)(n.code,{children:"VkCommandPoolCreateInfo"})," \u7ed3\u6784\u4f53\u6307\u9488\uff0c\u5305\u542b\u521b\u5efa\u547d\u4ee4\u7f13\u51b2\u6c60\u7684\u4fe1\u606f\u3002"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"pAllocator"})," : ",(0,o.jsx)(n.code,{children:"host memory"})," \u5206\u914d\u5668\u3002"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"pCommandPool"})," : \u521b\u5efa\u8fd4\u56de\u7684\u547d\u4ee4\u7f13\u51b2\u6c60\u53e5\u67c4\u3002"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"\u8865\u5145",children:"\u8865\u5145"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"VkCommandPoolCreateInfo"})," \u7ed3\u6784\u4f53\u5b9a\u4e49\uff1a"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"typedef struct VkCommandPoolCreateInfo {\n    VkStructureType             sType;\n    const void*                 pNext;\n    VkCommandPoolCreateFlags    flags;               //\u8bbe\u7f6e\u547d\u4ee4\u7f13\u51b2\u7684\u5206\u914d\u884c\u4e3a\n    uint32_t                    queueFamilyIndex;    //\u961f\u5217\u65cf\u7d22\u5f15\n} VkCommandPoolCreateInfo;\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"VkCommandPoolCreateFlags"})," \u679a\u4e3e\u5b9a\u4e49\uff1a"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"typedef enum VkCommandPoolCreateFlagBits {\n    VK_COMMAND_POOL_CREATE_TRANSIENT_BIT = 0x00000001,             //\u5728\u8f83\u77ed\u65f6\u95f4\u5185\u4f1a\u91cd\u590d\u91cd\u7f6e\u6216\u91ca\u653e\n    VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT = 0x00000002,  //\u547d\u4ee4\u7f13\u51b2\u5141\u8bb8\u4f7f\u7528vkResetCommandBuffer\u6216vkBeginCommandBuffer\u8fdb\u884c\u91cd\u7f6e\uff0c\u5426\u5219\u4e0d\u5141\u8bb8\u4f7f\u7528\n    VK_COMMAND_POOL_CREATE_PROTECTED_BIT = 0x00000004,\t\t\t\t  //\u53d7\u4fdd\u62a4\u7684\u547d\u4ee4\u7f13\u51b2\n} VkCommandPoolCreateFlagBits;\n"})}),"\n",(0,o.jsx)(n.h2,{id:"\u8fd4\u56de\u503c",children:"\u8fd4\u56de\u503c"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"VK_SUCCESS"})," : \u6210\u529f\u521b\u5efa\u547d\u4ee4\u7f13\u51b2\u6c60\u3002"]}),"\n",(0,o.jsx)(n.li,{children:"\u5176\u4ed6 : \u521b\u5efa\u5931\u8d25\u3002"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"\u4ee3\u7801\u793a\u4f8b",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-cpp",children:'// \u67e5\u8be2\u8bbe\u5907\u7684\u53ef\u7528\u961f\u5217\u65cf\uff0c-1\u4ee3\u8868\u65e0\u6548\nstruct  QueueFamilyIndices {\n\t// \u652f\u6301\u56fe\u50cf\u7ed8\u5236\u7684\u961f\u5217\n\tuint32_t graphicsFamily = -1;\n\n\t// \u652f\u6301\u56fe\u5f62\u5448\u73b0\u7684\u961f\u5217\n\tuint32_t presentFamily = -1;\n\n\tbool isComplete() {\n\t\treturn (graphicsFamily >= 0) && (presentFamily >= 0);\n\t}\n};\n\n// \u67e5\u8be2\u53ef\u7528\u7684\u56fe\u5f62\u961f\u5217\u548c\u5448\u73b0\u961f\u5217\nQueueFamilyIndices findQueueFamilies(VkPhysicalDevice device) {\n\tQueueFamilyIndices indices;\n\n\tuint32_t queueFamilyCount = 0;\n\tvkGetPhysicalDeviceQueueFamilyProperties(device, &queueFamilyCount, nullptr);\n\tvector<VkQueueFamilyProperties> queueFamilies(queueFamilyCount);\n\tvkGetPhysicalDeviceQueueFamilyProperties(device, &queueFamilyCount, queueFamilies.data());\n\n\tint index = 0;\n\tfor (const auto& queueFamily : queueFamilies) {\n\t\tif (queueFamily.queueFlags & VK_QUEUE_GRAPHICS_BIT) { // \u76ee\u524d\uff0c\u6211\u4eec\u53ea\u8981\u5bfb\u627e\u56fe\u5f62\u961f\u5217\u5373\u53ef\n\t\t\tindices.graphicsFamily = index;\n\t\t}\n\n\t\tVkBool32 presentSupport = false;\n\t\tvkGetPhysicalDeviceSurfaceSupportKHR(device, index, surface, &presentSupport);\n\t\tif (presentSupport) {\n\t\t\tindices.presentFamily = index;\n\t\t}\n\n\t\tif (indices.isComplete()) {\n\t\t\tbreak;\n\t\t}\n\t\tindex++;\n\t}\n\n\treturn indices;\n}\n\n// \u521b\u5efa\u6307\u4ee4\u6c60\nvoid createCommandPool() {\n\tQueueFamilyIndices queueFamilyIndices = findQueueFamilies(physicalDevice);\n\n\tVkCommandPoolCreateInfo poolInfo{};\n\tpoolInfo.sType = VK_STRUCTURE_TYPE_COMMAND_POOL_CREATE_INFO;\n\tpoolInfo.queueFamilyIndex = queueFamilyIndices.graphicsFamily;\n\n\tif (vkCreateCommandPool(device, &poolInfo, nullptr, &commandPool) != VK_SUCCESS) {\n\t\tthrow std::runtime_error("Failed to create command pool!");\n\t}\n}\n'})})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(s,{...e})}):s(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var o=t(6540);const i={},l=o.createContext(i);function a(e){const n=o.useContext(l);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(l.Provider,{value:n},e.children)}}}]);